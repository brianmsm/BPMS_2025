<!DOCTYPE html>
<html lang="en"><head>
<script src="presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Ricardo Rey-Sáez">
  <meta name="dcterms.date" content="2025-02-27">
  <title>Más Allá de Máxima Verosimilitud</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link href="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="presentation_files/libs/kePrint-0.0.1/kePrint.js"></script>

  <link href="presentation_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Más Allá de Máxima Verosimilitud</h1>
  <p class="subtitle">Introducción a la Psicometría Bayesiana</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Ricardo Rey-Sáez <a href="https://orcid.org/0000-0001-6739-2035" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:ricardoreysaez95@gmail.com">ricardoreysaez95@gmail.com</a>
</div>
        <p class="quarto-title-affiliation">
            Universidad Autónoma de Madrid
          </p>
    </div>
</div>

  <p class="date">February 27, 2025</p>
</section>
<section class="slide level2">

<!--- C:\Program Files\RStudio\resources\app\bin\quarto\share\formats\revealjs\themes --->
</section>
<section id="índice" class="slide level2">
<h2>Índice</h2>
<div>
<ul>
<li><strong>Universo</strong> frecuentista, <strong>multiverso</strong> bayesiano
<ul>
<li>Método de los momentos y máxima verosimilitud</li>
<li>Estimación bayesiana</li>
</ul></li>
<li>Introducción a la psicometría bayesiana</li>
<li>Estimación a través de <code>{blavaan}</code>
<ul>
<li>Prior predictive checks</li>
<li>Convergencia y eficiencia</li>
<li>Bondad de ajuste</li>
<li>Comparación de modelos</li>
<li>Posterior predictive checks</li>
</ul></li>
<li>Estimación a través de <em>Stan</em> y <code>{cmdstanr}</code></li>
</ul>
</div>
</section>
<section>
<section id="universo-frecuentista-multiverso-bayesiano" class="title-slide slide level1 smaller center">
<h1>Universo frecuentista, multiverso bayesiano</h1>

</section>
<section id="frecuentismo-qué-edad-tenéis" class="slide level2">
<h2>Frecuentismo: ¿qué edad tenéis?</h2>
<ul>
<li class="fragment">La media de edad es <strong>una cantidad fija, pero desconocida</strong> (<span class="math inline">\(\mu_{\text{edad}}\)</span>).</li>
<li class="fragment">El objetivo es estimar <span class="math inline">\(\mu_{\text{edad}}\)</span> <strong>usando una muestra aleatoria.</strong>
<ol type="1">
<li class="fragment"><strong>Elegimos un estimador</strong>: la media muestral.</li>
<li class="fragment"><strong>Cuantificamos la incertidumbre</strong>: el error típico de la media (SE).</li>
<li class="fragment">Usamos el SE y construimos un <strong>intervalo de confianza</strong> (IC) para inferir el valor de <span class="math inline">\(\mu_{\text{edad}}\)</span>.</li>
</ol></li>
<li class="fragment">Un frecuentista concluirá:
<ul>
<li class="fragment">La media de edad estimada es <span class="math inline">\(\hat\mu_{\text{edad}}\)</span> con un IC de <span class="math inline">\([a,b]\)</span>.</li>
<li class="fragment">Si <strong>repetimos este experimento <u>infinitas veces</u></strong>, el IC contendrá el valor de <span class="math inline">\(\mu_{\text{edad}}\)</span> en el 95% de los casos.</li>
</ul></li>
</ul>
</section>
<section id="bayesiano-qué-edad-tenéis" class="slide level2">
<h2>Bayesiano: ¿qué edad tenéis?</h2>
<ul>
<li class="fragment">La media de edad es <strong>una variable aleatoria</strong> porque incluimos <strong>nuestra incertidumbre sobre su valor <u>con una distribución de probabilidad.</u></strong></li>
<li class="fragment">El objetivo es combinar (1) los datos y (2) lo que creemos.
<ol type="1">
<li class="fragment">Elegimos una <strong>distribución a priori</strong> para <span class="math inline">\(\mu_{\text{edad}}\)</span>: <span class="math inline">\(\Pr(\mu_{\text{edad}})\)</span></li>
</ol></li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>¿Cómo incluimos nuestra incertidumbre en un modelo estadístico?</strong></p>
</div>
<div class="callout-content">
<div class="fragment">
<p>Si creo que vuestra edad está <strong>entre 22 y 26 años</strong>, puedo expresar esta creencia usando una distribución de probabilidad. Por ejemplo, puedo utilizar <strong>la distribución normal</strong> para reflejar lo que creo:</p>
</div>
<div class="fragment">
<p><span class="math display">\[
\Pr(\mu_{\text{edad}})\sim\mathcal{N}\left(\color{royalblue}{\mu = 24},\,\color{firebrick}{\sigma = 1}\right)
\]</span></p>
</div>
<div class="fragment">
<p>Esto significa que espero que la media de edad esté en torno a <span style="color:royalblue;"><strong>24 años</strong></span> y que, al mismo tiempo, creo que la edad del 95% de vosotros estará, aproxiadamente, entre 22 y 26 años:</p>
<ul>
<li class="fragment">Intervalo de confianza: <span class="math inline">\(\color{royalblue}{\mu}\pm1.96\cdot\color{firebrick}{\sigma}\Longrightarrow\color{royalblue}{24}\pm1.96\times\color{firebrick}1\approx[22, 26]\)</span></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bayesiano-qué-edad-tenéis-1" class="slide level2">
<h2>Bayesiano: ¿qué edad tenéis?</h2>
<div>
<ul>
<li>La media de edad es <strong>una variable aleatoria</strong> porque incluimos <strong>nuestra incertidumbre sobre su valor <u>con una distribución de probabilidad.</u></strong></li>
<li>El objetivo es combinar (1) los datos y (2) lo que creemos.
<ol type="1">
<li>Elegimos una <strong>distribución a priori</strong> para <span class="math inline">\(\mu_{\text{edad}}\)</span>: <span class="math inline">\(\Pr(\mu_{\text{edad}})\)</span></li>
<li>Combinamos la prior y los datos con el <strong>Teorema de Bayes.</strong></li>
</ol></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\mu_{\text{edad}} \mid D\right) \propto \Pr\left(D \mid \mu_{\text{edad}}\right) \times \Pr(\mu_{\text{edad}})
\]</span></p>
</div>
</section>
<section id="bayesiano-qué-edad-tenéis-2" class="slide level2">
<h2>Bayesiano: ¿qué edad tenéis?</h2>
<div>
<ul>
<li>La media de edad es <strong>una variable aleatoria</strong> porque incluimos <strong>nuestra incertidumbre sobre su valor <u>con una distribución de probabilidad.</u></strong></li>
<li>El objetivo es combinar (1) los datos y (2) lo que creemos.
<ol type="1">
<li>Elegimos una <strong>distribución a priori</strong> para <span class="math inline">\(\mu_{\text{edad}}\)</span>: <span class="math inline">\(\Pr(\mu_{\text{edad}})\)</span></li>
<li>Combinamos la prior y los datos con el <strong>Teorema de Bayes.</strong></li>
<li>Esta combinación es la <strong>distribución posterior.</strong></li>
</ol></li>
</ul>
</div>
<ul>
<li class="fragment">Un bayesiano concluirá:
<ul>
<li class="fragment">Tras ver los datos, mi antigua creencia (<strong>prior</strong>) sobre <span class="math inline">\(\mu_{\text{edad}}\)</span> se ha actualizado (<strong>posterior</strong>) .</li>
<li class="fragment">El <strong>intervalo de credibilidad</strong> al 95% nos dice que <strong>hay un 95% de probabilidad</strong> de que <span class="math inline">\(\mu_{\text{edad}}\)</span> esté en <span class="math inline">\([a,b]\)</span></li>
</ul></li>
</ul>
</section>
<section id="universo-frecuentista-multiverso-bayesiano-1" class="slide level2">
<h2>Universo frecuentista, multiverso bayesiano</h2>
<div class="columns" style="text-align: center;">
<div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Pierre-Simon Laplace</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/Pierre_Simon_Laplace.jpg" class="quarto-figure quarto-figure-center" style="height:9cm"></p>
</figure>
</div>
</div>
<div class="fragment">
<p><em>La inferencia Bayesiana es <strong>sentido común</strong> expresado en números.</em></p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Dennis Lindley</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/Dennis_Lindley.jpg" class="quarto-figure quarto-figure-center" style="height:10cm"></p>
</figure>
</div>
</div>
<div class="fragment">
<p><strong><em>La única estadística buena.</em></strong></p>
</div>
</div></div>
</section>
<section id="universo-frecuentista-multiverso-bayesiano-2" class="slide level2">
<h2>Universo frecuentista, multiverso bayesiano</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Frecuentismo</strong></p>
<ul>
<li class="fragment"><strong>Probabilidad:</strong> Frecuencia de eventos en repeticiones infinitas</li>
<li class="fragment"><strong>Parámetros:</strong> Constantes desconocidas</li>
<li class="fragment"><strong>Incertidumbre:</strong> Variabilidad del muestreo</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Bayesiano</strong></p>
<ul>
<li class="fragment"><strong>Probabilidad:</strong> Grado de creencia sobre un evento o parámetro</li>
<li class="fragment"><strong>Parámetros:</strong> Variables con una distribución de probabilidad</li>
<li class="fragment"><strong>Incertidumbre:</strong> Refleja el conocimiento antes y después de observar los datos</li>
</ul>
</div></div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>¿Cuál de las dos es más antigua?</strong></p>
</div>
<div class="callout-content">
<div class="fragment">
<p>Formalmente, la <strong>estadística bayesiana</strong>, que surge en el siglo XVIII.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="universo-frecuentista-multiverso-bayesiano-3" class="slide level2">
<h2>Universo frecuentista, multiverso bayesiano</h2>
<div class="columns" style="text-align: center;">
<div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Thomas Bayes</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/thomas_bayes.png" class="quarto-figure quarto-figure-center" style="height:12cm"></p>
</figure>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>&nbsp;</p>
<p><em>El único procedimiento estadístico que <strong>es coherente</strong>, es decir, que <strong>evita afirmaciones que sean internamente inconsistentes</strong>.</em></p>
<p>&nbsp;</p>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>El hombre de la foto no es Thomas Bayes</strong></p>
</div>
<div class="callout-content">
<p>Aun así, este autorretrato sigue usándose en los cursos de estadística Bayesiana.</p>
</div>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="universo-frecuentista-multiverso-bayesiano-4" class="slide level2">
<h2>Universo frecuentista, multiverso bayesiano</h2>
<p>Cada año, Carmen Ximénez y Javier Revuelta, como coordinadores del <a href="https://www.metodologiaccs.es">Máster de Metodología de las Ciencias del Comportamiento y de la Salud</a>, deben decidir cuántos Trabajos de Fin de Máster (TFM) de investigación y de prácticas van a ofertar.</p>
<p>Para ello, necesitan conocer la proporción esperada de estudiantes que optarán por un TFM de investigación. Denotemos esta proporción como <span class="math inline">\(\theta\)</span>, un valor desconocido que podemos estimar a partir de los datos del curso anterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># TFMs de investigación el último año</span></span>
<span id="cb1-2"><a href=""></a>TFM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,</span>
<span id="cb1-3"><a href=""></a>         <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-método-de-los-momentos" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: método de los momentos</h2>
<p>En esta situación, el <em>método de los momentos</em> es la media aritmética de la variable <code>TFM</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># Estimación de \theta con el método de los momentos</span></span>
<span id="cb2-2"><a href=""></a><span class="fu">mean</span>(TFM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<p>Como <span class="math inline">\(\hat\theta=0.6\)</span>, el 60% de los alumnos escogieron un TFM de investigación el año pasado.</p>
</section>
<section id="estimando-theta-máxima-verosimilitud" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>
<ul>
<li class="fragment">Necesitamos un <strong>modelo de probabilidad</strong> adecuado.
<ul>
<li class="fragment">Dado que cada estudiante elige entre dos opciones, podemos modelar su decisión con la <strong>distribución de Bernoulli</strong></li>
</ul></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\text{TFM}_i=1\right)\sim\mbox{Bernoulli}\left(\theta\right)
\]</span></p>
</div>
<ul>
<li class="fragment">Probabilidad de escoger un TFM de investigación: <span class="math inline">\(\theta\)</span></li>
<li class="fragment">Probabilidad de escoger un TFM de prácticas: <span class="math inline">\(1-\theta\)</span></li>
<li class="fragment">En <code>R</code>, la ecuación anterior se representa con <code>dbinom</code>, indicando <code>size=1</code>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># Función de densidad de bernoulli</span></span>
<span id="cb4-2"><a href=""></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="st">"TFM_i"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="st">"theta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="estimando-theta-máxima-verosimilitud-1" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>
<ul>
<li class="fragment">Sin embargo, nuestro interés no está en cada estudiante por separado, sino en <strong>la verosimilitud conjunta de los datos</strong>.</li>
<li class="fragment">Cada alumno elige un TFM <strong>independientemente</strong> de lo que elijan los demás.</li>
<li class="fragment">La <strong>verosimilitud conjunta</strong> se obtiene <strong>multiplicando las verosimilitudes individuales de los alumnos</strong>.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(D \mid \theta\right) = \prod^N_{i=1}\mbox{Bernoulli}\left(\text{TFM}_i\mid\theta\right)
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Función de verosimilitud de los datos</span></span>
<span id="cb5-2"><a href=""></a><span class="fu">prod</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="st">"TFM_i"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="st">"theta"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="estimando-theta-máxima-verosimilitud-2" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>
<ul>
<li class="fragment">¿Cómo de verosímil es que <span class="math inline">\(\theta=0.2\)</span> en nuestros datos?</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="co"># Verosimilitud de los datos cuando \theta = 0.2</span></span>
<span id="cb6-2"><a href=""></a><span class="fu">prod</span>(<span class="fu">dbinom</span>(TFM, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.871948e-10</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">El valor <code>6.871948e-10</code> representa la verosimilitud de los datos dado un valor de <span class="math inline">\(\theta = 0.2\)</span>. ¿Qué tal si probamos ahora <span class="math inline">\(\theta = 0.3\)</span>?</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="co"># Verosimilitud de los datos cuando \theta = 0.3</span></span>
<span id="cb8-2"><a href=""></a><span class="fu">prod</span>(<span class="fu">dbinom</span>(TFM, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.063652e-08</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Como <code>3.063652e-08</code> es mayor que <code>6.871948e-10</code>, <span class="math inline">\(\theta=0.3\)</span> explica mejor los datos que <span class="math inline">\(\theta=0.2\)</span>.</li>
</ul>
</section>
<section id="estimando-theta-máxima-verosimilitud-3" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>
<p>¿Qué pasa si repetimos este mismo proceso para todos los valores de <span class="math inline">\(\theta\)</span> entre 0 y 1?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="|1-2|3-4|5-8|9-10|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="co"># Valores de theta de 0 a 1</span></span>
<span id="cb10-2"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-3"><a href=""></a><span class="co"># Vector vacío para guardar la verosimilitud con cada theta</span></span>
<span id="cb10-4"><a href=""></a>likelihood <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(theta))</span>
<span id="cb10-5"><a href=""></a><span class="co"># Verosimilitud para cada theta</span></span>
<span id="cb10-6"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)){</span>
<span id="cb10-7"><a href=""></a>  likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">dbinom</span>(TFM, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> theta[i]))</span>
<span id="cb10-8"><a href=""></a>}</span>
<span id="cb10-9"><a href=""></a><span class="co"># Gráfico de densidad</span></span>
<span id="cb10-10"><a href=""></a><span class="fu">plot</span>(theta, likelihood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-máxima-verosimilitud-4" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"><ul>
<li class="fragment"><strong>¿Cuál es el valor de</strong> <span class="math inline">\(\boldsymbol\theta\)</span> <strong>que maximiza la verosimilitud?</strong></li>
</ul>
</section>
<section id="estimando-theta-máxima-verosimilitud-5" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"><div>
<ul>
<li><strong>¿Cuál es el valor de</strong> <span class="math inline">\(\boldsymbol\theta\)</span> <strong>que maximiza la verosimilitud?</strong></li>
</ul>
</div>
</section>
<section id="estimando-theta-máxima-verosimilitud-6" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"><div>
<ul>
<li><strong>¿Cuál es el valor de</strong> <span class="math inline">\(\boldsymbol\theta\)</span> <strong>que maximiza la verosimilitud?</strong></li>
</ul>
</div>
</section>
<section id="estimando-theta-máxima-verosimilitud-7" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: máxima verosimilitud</h2>
<div>
<ul>
<li><strong>¿Cuál es el valor de</strong> <span class="math inline">\(\boldsymbol\theta\)</span> <strong>que maximiza la verosimilitud?</strong></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="co"># Valor de theta que maximiza la verosimilitud</span></span>
<span id="cb11-2"><a href=""></a>theta[<span class="fu">which.max</span>(likelihood)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Este valor de <span class="math inline">\(\hat\theta=0.6\)</span> coincide con el que hemos obtenido antes utilizando el <em>método de los momentos.</em></li>
</ul>
</section>
<section id="estimando-theta-estimación-bayesiana" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">La <strong>estimación bayesiana</strong> es, ante todo, estimación basada en la verosimilitud, y su corazón es el <strong>Teorema de Bayes:</strong></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) \propto \Pr\left(D \mid \theta\right) \times \Pr(\theta)
\]</span></p>
</div>
<ul>
<li class="fragment"><strong>Verosimilitud:</strong> <span class="math inline">\(\Pr\left(D \mid \theta\right)\)</span></li>
<li class="fragment"><strong>Probabilidad a priori:</strong> <span class="math inline">\(\Pr(\theta)\)</span></li>
<li class="fragment"><strong>Probabilidad posterior:</strong> <span class="math inline">\(\Pr\left(\theta \mid D\right)\)</span></li>
</ul>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>El símbolo <span class="math inline">\(\propto\)</span> significa <em>“proporcional a”</em>, y no <em>“igual a”</em>. Esto se debe a que la distribución posterior es una distribución de probabilidad, es decir, la suma de sus valores es 1. Sin embargo, esto no se cumple con el producto de la verosimilitud y la distribución a priori.</p>
</div>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-1" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">Alternativamente, el <strong>Teorema de Bayes</strong> también se representa como</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\Pr(D)}
\]</span></p>
</div>
<ul>
<li class="fragment"><span class="math inline">\(\Pr(D)\)</span> recibe el nombre de <em>verosimilitud marginal</em>, y no es más que el sumatorio de todos los valores de <span class="math inline">\(\Pr\left(D \mid \theta\right) \times \Pr(\theta)\)</span>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="co"># Ejemplo</span></span>
<span id="cb13-2"><a href=""></a>likelihood <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">8</span>, .<span class="dv">8</span>); prior <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">5</span>)</span>
<span id="cb13-3"><a href=""></a><span class="co"># Sin dividir entre su sumatorio</span></span>
<span id="cb13-4"><a href=""></a>likelihood <span class="sc">*</span> prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04 0.40 0.40</code></pre>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-2" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Alternativamente, el <strong>Teorema de Bayes</strong> también se representa como</li>
</ul>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\Pr(D)}
\]</span></p>
<ul>
<li><span class="math inline">\(\Pr(D)\)</span> recibe el nombre de <em>verosimilitud marginal</em>, y no es más que el sumatorio de todos los valores de <span class="math inline">\(\Pr\left(D \mid \theta\right) \times \Pr(\theta)\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="co"># Ejemplo</span></span>
<span id="cb15-2"><a href=""></a>likelihood <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">8</span>, .<span class="dv">8</span>); prior <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">5</span>)</span>
<span id="cb15-3"><a href=""></a><span class="co"># Dividiendo entre su sumatorio</span></span>
<span id="cb15-4"><a href=""></a>likelihood <span class="sc">*</span> prior<span class="sc">/</span><span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04761905 0.47619048 0.47619048</code></pre>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-3" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Alternativamente, el <strong>Teorema de Bayes</strong> también se representa como</li>
</ul>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\Pr(D)}
\]</span></p>
<ul>
<li><span class="math inline">\(\Pr(D)\)</span> recibe el nombre de <em>verosimilitud marginal</em>, y no es más que el sumatorio de todos los valores de <span class="math inline">\(\Pr\left(D \mid \theta\right) \times \Pr(\theta)\)</span>.</li>
</ul>
</div>
<ul>
<li class="fragment">Esto garantiza que la <strong>distribución posterior</strong>, <span class="math inline">\(\Pr\left(\theta \mid D\right)\)</span>, sea una <strong>distribución de probabilidad válida.</strong></li>
<li class="fragment">La <em>verosimilitud marginal</em> es <strong>imprescindible</strong> en la comparación de modelos a través del <strong>factor de Bayes.</strong></li>
</ul>
</section>
<section id="estimando-theta-estimación-bayesiana-4" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">Carmen y Javier han recuperado la selección de TFMs de los cursos académicos.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div id="ckntfehzbm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ckntfehzbm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ckntfehzbm thead, #ckntfehzbm tbody, #ckntfehzbm tfoot, #ckntfehzbm tr, #ckntfehzbm td, #ckntfehzbm th {
  border-style: none;
}

#ckntfehzbm p {
  margin: 0;
  padding: 0;
}

#ckntfehzbm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 26px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 90%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ckntfehzbm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ckntfehzbm .gt_title {
  color: #333333;
  font-size: 32px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ckntfehzbm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ckntfehzbm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckntfehzbm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckntfehzbm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckntfehzbm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ckntfehzbm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ckntfehzbm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ckntfehzbm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ckntfehzbm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ckntfehzbm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ckntfehzbm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ckntfehzbm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ckntfehzbm .gt_from_md > :first-child {
  margin-top: 0;
}

#ckntfehzbm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ckntfehzbm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ckntfehzbm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ckntfehzbm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ckntfehzbm .gt_row_group_first td {
  border-top-width: 2px;
}

#ckntfehzbm .gt_row_group_first th {
  border-top-width: 2px;
}

#ckntfehzbm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckntfehzbm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ckntfehzbm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ckntfehzbm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckntfehzbm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckntfehzbm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ckntfehzbm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ckntfehzbm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ckntfehzbm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckntfehzbm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckntfehzbm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckntfehzbm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckntfehzbm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckntfehzbm .gt_left {
  text-align: left;
}

#ckntfehzbm .gt_center {
  text-align: center;
}

#ckntfehzbm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ckntfehzbm .gt_font_normal {
  font-weight: normal;
}

#ckntfehzbm .gt_font_bold {
  font-weight: bold;
}

#ckntfehzbm .gt_font_italic {
  font-style: italic;
}

#ckntfehzbm .gt_super {
  font-size: 65%;
}

#ckntfehzbm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ckntfehzbm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ckntfehzbm .gt_indent_1 {
  text-indent: 5px;
}

#ckntfehzbm .gt_indent_2 {
  text-indent: 10px;
}

#ckntfehzbm .gt_indent_3 {
  text-indent: 15px;
}

#ckntfehzbm .gt_indent_4 {
  text-indent: 20px;
}

#ckntfehzbm .gt_indent_5 {
  text-indent: 25px;
}

#ckntfehzbm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ckntfehzbm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Selección de TFM de prácticas e investigación</strong></th>
</tr>
<tr class="odd gt_col_headings">
<th id="Curso" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Curso</strong></th>
<th id="Investigación" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Investigación</strong></th>
<th id="Prácticas" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Prácticas</strong></th>
<th id="theta" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><span><span class="math inline">\(\hat{\theta}\)</span></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Curso">2018/2019</td>
<td class="gt_row gt_center" headers="Investigación">10</td>
<td class="gt_row gt_center" headers="Prácticas">14</td>
<td class="gt_row gt_center" headers="theta">0.417</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Curso">2019/2020</td>
<td class="gt_row gt_center" headers="Investigación">5</td>
<td class="gt_row gt_center" headers="Prácticas">15</td>
<td class="gt_row gt_center" headers="theta">0.250</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Curso">2020/2021</td>
<td class="gt_row gt_center" headers="Investigación">17</td>
<td class="gt_row gt_center" headers="Prácticas">13</td>
<td class="gt_row gt_center" headers="theta">0.567</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Curso">2021/2022</td>
<td class="gt_row gt_center" headers="Investigación">13</td>
<td class="gt_row gt_center" headers="Prácticas">15</td>
<td class="gt_row gt_center" headers="theta">0.464</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Curso">2022/2023</td>
<td class="gt_row gt_center" headers="Investigación">8</td>
<td class="gt_row gt_center" headers="Prácticas">18</td>
<td class="gt_row gt_center" headers="theta">0.308</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<ul>
<li class="fragment"><span class="math inline">\(\hat\theta\)</span> es nuestro <strong>conocimiento previo</strong> de la selección de TFMs.</li>
</ul>
</section>
<section id="estimando-theta-estimación-bayesiana-5" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">La media de <span class="math inline">\(\hat\theta\)</span> es 0.40, y su desviación típica es 0.12.</li>
<li class="fragment">Podemos utilizar esta información con la <strong>distribución a priori</strong>.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = 0.4,\, \sigma_\theta = 0.12\right)
\]</span></p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-6" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">El siguiente código de <code>R</code> muestra cómo surge toda la magia que crea la famosa distribución posterior.</li>
<li class="fragment">En primer lugar, calculamos (otra vez) <strong>la verosimilitud de los datos</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-code-line-numbers="1-2|3-4|5-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="co"># Valores de theta de 0 a 1</span></span>
<span id="cb17-2"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb17-3"><a href=""></a><span class="co"># Vector vacío para guardar la verosimilitud con cada theta</span></span>
<span id="cb17-4"><a href=""></a>likelihood <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(theta))</span>
<span id="cb17-5"><a href=""></a><span class="co"># Verosimilitud para cada theta</span></span>
<span id="cb17-6"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)){</span>
<span id="cb17-7"><a href=""></a>  likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">dbinom</span>(TFM, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> theta[i]))</span>
<span id="cb17-8"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-7" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">Aplicamos el <strong>Teorema de Bayes</strong>:</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\Pr(D)}=\frac{\text{Verosimilitud }\times\text{ Prior}}{\text{Verosimilitud marginal}}
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="co"># Distribución a priori de theta</span></span>
<span id="cb18-2"><a href=""></a>prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(theta, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="fl">0.12</span>)</span>
<span id="cb18-3"><a href=""></a><span class="co"># Distribución posterior (proporcional)</span></span>
<span id="cb18-4"><a href=""></a>posterior_prop <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb18-5"><a href=""></a><span class="co"># Verosimilitud marginal</span></span>
<span id="cb18-6"><a href=""></a>marginal <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb18-7"><a href=""></a><span class="co"># Distribución posterior escalada a [0,1]</span></span>
<span id="cb18-8"><a href=""></a>posterior <span class="ot">&lt;-</span> posterior_prop<span class="sc">/</span>marginal </span>
<span id="cb18-9"><a href=""></a><span class="fu">plot</span>(theta, posterior) <span class="co"># Gráfico de densidad posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-8" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Aplicamos el <strong>Teorema de Bayes</strong>:</li>
</ul>
</div>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \color{darkorange}{\Pr(\theta)}}{\Pr(D)}=\frac{\text{Verosimilitud }\times\color{darkorange}{\text{ Prior}}}{\text{Verosimilitud marginal}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-code-line-numbers="1-2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="co"># Distribución a priori de theta</span></span>
<span id="cb19-2"><a href=""></a>prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(theta, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="fl">0.12</span>)</span>
<span id="cb19-3"><a href=""></a><span class="co"># Distribución posterior (proporcional)</span></span>
<span id="cb19-4"><a href=""></a>posterior_prop <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb19-5"><a href=""></a><span class="co"># Verosimilitud marginal</span></span>
<span id="cb19-6"><a href=""></a>marginal <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb19-7"><a href=""></a><span class="co"># Distribución posterior escalada a [0,1]</span></span>
<span id="cb19-8"><a href=""></a>posterior <span class="ot">&lt;-</span> posterior_prop<span class="sc">/</span>marginal </span>
<span id="cb19-9"><a href=""></a><span class="fu">plot</span>(theta, posterior) <span class="co"># Gráfico de densidad posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-9" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Aplicamos el <strong>Teorema de Bayes</strong>:</li>
</ul>
</div>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\color{darkorange}{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}}{\Pr(D)}=\frac{\color{darkorange}{\text{Verosimilitud }\times\text{ Prior}}}{\text{Verosimilitud marginal}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="3-4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="co"># Distribución a priori de theta</span></span>
<span id="cb20-2"><a href=""></a>prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(theta, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="fl">0.12</span>)</span>
<span id="cb20-3"><a href=""></a><span class="co"># Distribución posterior (proporcional)</span></span>
<span id="cb20-4"><a href=""></a>posterior_prop <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb20-5"><a href=""></a><span class="co"># Verosimilitud marginal</span></span>
<span id="cb20-6"><a href=""></a>marginal <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb20-7"><a href=""></a><span class="co"># Distribución posterior escalada a [0,1]</span></span>
<span id="cb20-8"><a href=""></a>posterior <span class="ot">&lt;-</span> posterior_prop<span class="sc">/</span>marginal </span>
<span id="cb20-9"><a href=""></a><span class="fu">plot</span>(theta, posterior) <span class="co"># Gráfico de densidad posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-10" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Aplicamos el <strong>Teorema de Bayes</strong>:</li>
</ul>
</div>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\color{royalblue}{\Pr(D)}}=\frac{\text{Verosimilitud }\times\text{ Prior}}{\color{royalblue}{\text{Verosimilitud marginal}}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-code-line-numbers="5-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># Distribución a priori de theta</span></span>
<span id="cb21-2"><a href=""></a>prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(theta, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="fl">0.12</span>)</span>
<span id="cb21-3"><a href=""></a><span class="co"># Distribución posterior (proporcional)</span></span>
<span id="cb21-4"><a href=""></a>posterior_prop <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb21-5"><a href=""></a><span class="co"># Verosimilitud marginal</span></span>
<span id="cb21-6"><a href=""></a>marginal <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb21-7"><a href=""></a><span class="co"># Distribución posterior escalada a [0,1]</span></span>
<span id="cb21-8"><a href=""></a>posterior <span class="ot">&lt;-</span> posterior_prop<span class="sc">/</span>marginal </span>
<span id="cb21-9"><a href=""></a><span class="fu">plot</span>(theta, posterior) <span class="co"># Gráfico de densidad posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-11" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>Aplicamos el <strong>Teorema de Bayes</strong>:</li>
</ul>
</div>
<p><span class="math display">\[
\color{red}{\Pr\left(\theta \mid D\right)} = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\Pr(D)}=\frac{\text{Verosimilitud }\times\text{ Prior}}{\text{Verosimilitud marginal}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" data-code-line-numbers="7-8|9|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="co"># Distribución a priori de theta</span></span>
<span id="cb22-2"><a href=""></a>prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(theta, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="fl">0.12</span>)</span>
<span id="cb22-3"><a href=""></a><span class="co"># Distribución posterior (proporcional)</span></span>
<span id="cb22-4"><a href=""></a>posterior_prop <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb22-5"><a href=""></a><span class="co"># Verosimilitud marginal</span></span>
<span id="cb22-6"><a href=""></a>marginal <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb22-7"><a href=""></a><span class="co"># Distribución posterior escalada a [0,1]</span></span>
<span id="cb22-8"><a href=""></a>posterior <span class="ot">&lt;-</span> posterior_prop<span class="sc">/</span>marginal </span>
<span id="cb22-9"><a href=""></a><span class="fu">plot</span>(theta, posterior) <span class="co"># Gráfico de densidad posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-12" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="estimando-theta-estimación-bayesiana-13" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">La <strong>moda posterior</strong> suele utilizarse como estadísticos de resumen de <strong>la distribución posterior</strong>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="co"># Moda de la distribución posterior</span></span>
<span id="cb23-2"><a href=""></a>theta[<span class="fu">which.max</span>(posterior)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.51</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Es distinto del valor que obtendríamos por <strong>máxima verosimilitud</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="co"># Estimación máximo-verosimil</span></span>
<span id="cb25-2"><a href=""></a>theta[<span class="fu">which.max</span>(likelihood)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">La <strong>distribución a priori</strong> es responsable de esta diferencia</li>
</ul>
</section>
<section id="estimando-theta-estimación-bayesiana-14" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{0.1}\right)
\]</span></p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-15" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
</div>
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{0.1}\right)
\]</span></p>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="estimando-theta-estimación-bayesiana-16" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
</div>
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{1}\right)
\]</span></p>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-28-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="estimando-theta-estimación-bayesiana-17" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
</div>
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{5}\right)
\]</span></p>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-29-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="estimando-theta-estimación-bayesiana-18" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
</div>
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{5}\right)
\]</span></p>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="estimando-theta-estimación-bayesiana-19" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div>
<ul>
<li>¿Qué pasa si utilizamos una distribución a priori menos <em>informativa</em>?</li>
</ul>
</div>
<div>
<p><span class="math display">\[
\theta \sim \mathcal{N}\left(\mu_\theta = \color{royalblue}{0.5},\, \sigma_\theta = \color{royalblue}{5}\right)
\]</span></p>
</div>
<ul>
<li class="fragment">La probabilidad a priori para cualquier valor de <span class="math inline">\(\theta\)</span> <strong>es prácticamente la misma.</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="co"># Prior no informativa sobre theta</span></span>
<span id="cb27-2"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>)</span>
<span id="cb27-3"><a href=""></a><span class="fu">round</span>(<span class="fu">dnorm</span>(theta, <span class="fl">0.5</span>, <span class="dv">5</span>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0794 0.0795 0.0796 0.0797 0.0798 0.0798 0.0798 0.0797 0.0796 0.0795
[11] 0.0794</code></pre>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-20" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<ul>
<li class="fragment">Las <strong>distribuciones a priori planas</strong>, como la <strong>distribución uniforme</strong>, son los casos más extremos de distribuciones a priori no informativas.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\theta\sim\mbox{Uniform}\left(a = 0,\, b = 1\right)
\]</span></p>
</div>
<ul>
<li class="fragment">Se asigna una <strong>probabilidad constante</strong> a todo valor en el rango <span class="math inline">\([a,b]\)</span></li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-21" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>) <span class="co"># Valores de theta</span></span>
<span id="cb29-2"><a href=""></a><span class="fu">dunif</span>(theta, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># Prior uniforme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">¿Qué implicaciones tiene esto para el <strong>Teorema de Bayes</strong>?</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) \propto \Pr\left(D \mid \theta\right) \times \color{red}{\Pr(\theta)}
\]</span></p>
</div>
</section>
<section id="estimando-theta-estimación-bayesiana-22" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>) <span class="co"># Valores de theta</span></span>
<span id="cb31-2"><a href=""></a><span class="fu">dunif</span>(theta, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># Prior uniforme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<div>
<ul>
<li>¿Qué implicaciones tiene esto para el <strong>Teorema de Bayes</strong>?</li>
</ul>
</div>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) \propto \Pr\left(D \mid \theta\right) \times \color{red}{\boldsymbol{1}}\\
\]</span></p>
</section>
<section id="estimando-theta-estimación-bayesiana-23" class="slide level2">
<h2>Estimando <span class="math inline">\(\theta\)</span>: estimación bayesiana</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>) <span class="co"># Valores de theta</span></span>
<span id="cb33-2"><a href=""></a><span class="fu">dunif</span>(theta, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># Prior uniforme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<div>
<ul>
<li>¿Qué implicaciones tiene esto para el <strong>Teorema de Bayes</strong>?</li>
</ul>
</div>
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) \color{red}= \Pr\left(D \mid \theta\right)
\]</span></p>
<ul>
<li class="fragment">La <strong>distribución posterior</strong> es <span style="color:red;"><strong>lo mismo</strong></span> que <strong>la verosimilitud</strong>.</li>
</ul>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Universo frecuentista, multiverso bayesiano</strong></p>
</div>
<div class="callout-content">
<p>La <strong>estadística frecuentista</strong> sólo es <span style="color:red;"><strong>un caso particular</strong></span> dentro de la <strong>estadística bayesiana</strong>.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov" class="title-slide slide level1 center">
<h1>Máxima verosimilitud Vs. Cadenas de Markov</h1>

</section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-1" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<ul>
<li class="fragment">Máxima verosimilitud utiliza <strong>algoritmos de optimización numérica</strong> para encontrar <strong>un valor máximo</strong>.</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-37-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-2" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<ul>
<li class="fragment">En ocasiones, puede encontrar un máximo local, pero no un <em>máximo absoluto.</em></li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-38-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-3" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<ul>
<li class="fragment">Las Cadenas de Markov utilizan métodos de simulación Monte Carlo para recuperar <strong>toda una distribución, no un único valor</strong></li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-4" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<div>
<ul>
<li>Las Cadenas de Markov utilizan métodos de simulación Monte Carlo para recuperar <strong>toda una distribución, no un único valor</strong></li>
</ul>
</div>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-40-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-5" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<div>
<ul>
<li>Las Cadenas de Markov utilizan métodos de simulación Monte Carlo para recuperar <strong>toda una distribución, no un único valor</strong></li>
<li>Se realizan <span class="math inline">\(n\)</span> <strong>extracciones</strong> de la distribución posterior.</li>
</ul>
</div>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-41-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="máxima-verosimilitud-vs.-cadenas-de-markov-6" class="slide level2">
<h2>Máxima verosimilitud Vs. Cadenas de Markov</h2>
<div>
<ul>
<li>Las Cadenas de Markov utilizan métodos de simulación Monte Carlo para recuperar <strong>toda una distribución, no un único valor</strong></li>
<li>Se realizan <span class="math inline">\(n\)</span> <strong>extracciones</strong> de la distribución posterior.</li>
<li>Los <strong>valores más probables</strong> aparecerán con <strong>mayor frecuencia</strong>.</li>
</ul>
</div>
<ul>
<li class="fragment">Los algoritmos que se suelen aplicar <strong>difieren en eficiencia y flexibilidad</strong>.
<ul>
<li class="fragment">Sampleador de Gibbs (implementado en <strong>JAGS</strong>).</li>
<li class="fragment">Monte Carlo Hamiltoniano (implementado en <strong>Stan</strong>).</li>
</ul></li>
<li class="fragment">Visualmente podemos ver cómo <strong>difieren en su forma de extraer muestras.</strong>
<ul>
<li class="fragment"><a href="https://chi-feng.github.io/mcmc-demo/app.html">Visualizador de algoritmos MCMC</a></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="introducción-a-la-psicometría-bayesiana" class="title-slide slide level1 center">
<h1>Introducción a la Psicometría Bayesiana</h1>

</section>
<section id="qué-es-modelar" class="slide level2">
<h2>¿Qué es modelar?</h2>

<img data-src="Images/modeling1.png" class="r-stretch"></section>
<section id="qué-es-modelar-1" class="slide level2">
<h2>¿Qué es modelar?</h2>

<img data-src="Images/modeling2.png" class="r-stretch"></section>
<section id="qué-es-modelar-2" class="slide level2">
<h2>¿Qué es modelar?</h2>

<img data-src="Images/modeling3.png" class="r-stretch"></section>
<section id="qué-es-modelar-3" class="slide level2">
<h2>¿Qué es modelar?</h2>
<ul>
<li class="fragment">Es habitual expresar un <strong>modelo de regresión lineal</strong> como</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\color{seagreen}{Y_i} = \color{#0197FD}{\beta_0 + \beta_1\cdot X_i} + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\color{#7E57C2}{\mathcal{N}}\left(\color{#9a2515}\mu =0,\, \color{#9a2515}{\sigma} = \color{#0197FD}{\sigma_\varepsilon}\right)
\]</span></p>
</div>
<ul>
<li class="fragment">Esto <strong>es idéntico</strong> a</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\color{seagreen}{Y_i} \sim \color{#7E57C2}{\mathcal{N}}\left(\color{#9a2515}\mu = \color{#0197FD}{\beta_0 + \beta_1\cdot X_i},\,\color{#9a2515}{\sigma} = \color{#0197FD}{\sigma_\varepsilon} \right)
\]</span></p>
</div>
<ul>
<li class="fragment">Por tanto, el <strong>modelo estadístico</strong> cuenta con:
<ul>
<li class="fragment">Una <span style="color:seagreen;"><strong>variable dependiente</strong></span> y una <span style="color:#7E57C2;"><strong>distribución de probabilidad</strong></span>,</li>
<li class="fragment">los <span style="color:#9a2515;"><strong>parámetros</strong></span> de la <span style="color:#7E57C2;"><strong>distribución de probabilidad</strong></span> seleccionada.</li>
<li class="fragment">los <span style="color:#0197FD;"><strong>pronósticos</strong></span> de la ecuación lineal (i.e., la parte <span style="color:#0197FD;"><strong>determinista</strong></span>).</li>
</ul></li>
</ul>
</section>
<section id="el-modelo-psicométrico-del-factor-común" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<ul>
<li class="fragment">La psicometría se asienta sobre el modelo de regresión lineal.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1\cdot X_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \sigma_\varepsilon\right)
\]</span></p>
</div>
<ul>
<li class="fragment">Sin embargo, en psicometría:
<ul>
<li class="fragment">se asume que la variable <span class="math inline">\(X\)</span> <strong>es latente en lugar de observable</strong>. Se suele representar con la letra griega <span class="math inline">\(\eta\)</span>.</li>
<li class="fragment">suelen utilizarse las letras griegas <span class="math inline">\(\nu\)</span>, <span class="math inline">\(\lambda\)</span> y <span class="math inline">\(\theta\)</span> en lugar de <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> y <span class="math inline">\(\sigma_\varepsilon\)</span>.</li>
</ul></li>
<li class="fragment">Por eso, <u><strong>el mismo modelo</strong></u> se representa como</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-1" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
<ul>
<li class="fragment"><span class="math inline">\(Y_i\)</span> es <strong>una medida imperfecta</strong> de una variable no observable, <span class="math inline">\(\eta_i\)</span>.</li>
<li class="fragment"><span class="math inline">\(\varepsilon_i\)</span> recibe el nombre de <strong>unicidad</strong> (i.e., varianza no explicada).
<ul>
<li class="fragment">Una parte de la <strong>unicidad</strong> es el <strong>error de medida</strong></li>
</ul></li>
<li class="fragment">Es habitual contar con <strong>varias medidas de la variable no observable</strong>.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{i1} = \nu_1 + \lambda_1 \cdot \eta_i + \varepsilon_{i1},\quad\text{donde}\quad\varepsilon_{i1}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_1\right)
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-2" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
<div>
<ul>
<li><span class="math inline">\(Y_i\)</span> es <strong>una medida imperfecta</strong> de una variable no observable, <span class="math inline">\(\eta_i\)</span>.</li>
<li><span class="math inline">\(\varepsilon_i\)</span> recibe el nombre de <strong>unicidad</strong> (i.e., varianza no explicada).
<ul>
<li>Una parte de la <strong>unicidad</strong> es el <strong>error de medida</strong></li>
</ul></li>
<li>Es habitual contar con <strong>varias medidas de la variable no observable</strong>.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{i1} = \nu_1 + \lambda_1 \cdot \eta_i + \varepsilon_{i1},\quad\text{donde}\quad\varepsilon_{i1}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_1\right)\\
&amp; Y_{i2} = \nu_2 + \lambda_2 \cdot \eta_i + \varepsilon_{i2},\quad\text{donde}\quad\varepsilon_{i2}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_2\right)
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-3" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
<div>
<ul>
<li><span class="math inline">\(Y_i\)</span> es <strong>una medida imperfecta</strong> de una variable no observable, <span class="math inline">\(\eta_i\)</span>.</li>
<li><span class="math inline">\(\varepsilon_i\)</span> recibe el nombre de <strong>unicidad</strong> (i.e., varianza no explicada).
<ul>
<li>Una parte de la <strong>unicidad</strong> es el <strong>error de medida</strong></li>
</ul></li>
<li>Es habitual contar con <strong>varias medidas de la variable no observable</strong>.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{i1} = \nu_1 + \lambda_1 \cdot \eta_i + \varepsilon_{i1},\quad\text{donde}\quad\varepsilon_{i1}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_1\right)\\
&amp; Y_{i2} = \nu_2 + \lambda_2 \cdot \eta_i + \varepsilon_{i2},\quad\text{donde}\quad\varepsilon_{i2}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_2\right)\\
&amp; Y_{i3} = \nu_3 + \lambda_3 \cdot \eta_i + \varepsilon_{i3},\quad\text{donde}\quad\varepsilon_{i3}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_3\right)\\
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-4" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
<div>
<ul>
<li><span class="math inline">\(Y_i\)</span> es <strong>una medida imperfecta</strong> de una variable no observable, <span class="math inline">\(\eta_i\)</span>.</li>
<li><span class="math inline">\(\varepsilon_i\)</span> recibe el nombre de <strong>unicidad</strong> (i.e., varianza no explicada).
<ul>
<li>Una parte de la <strong>unicidad</strong> es el <strong>error de medida</strong></li>
</ul></li>
<li>Es habitual contar con <strong>varias medidas de la variable no observable</strong>.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{i1} = \nu_1 + \lambda_1 \cdot \color{royalblue}{\eta_i} + \varepsilon_{i1},\quad\text{donde}\quad\varepsilon_{i1}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_1\right)\\
&amp; Y_{i2} = \nu_2 + \lambda_2 \cdot \color{royalblue}{\eta_i} + \varepsilon_{i2},\quad\text{donde}\quad\varepsilon_{i2}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_2\right)\\
&amp; Y_{i3} = \nu_3 + \lambda_3 \cdot \color{royalblue}{\eta_i} + \varepsilon_{i3},\quad\text{donde}\quad\varepsilon_{i3}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_3\right)\\
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-5" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<p><span class="math display">\[
Y_i = \nu + \lambda \cdot \eta_i + \varepsilon_i,\quad\text{donde}\quad\varepsilon_i\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta\right)
\]</span></p>
<div>
<ul>
<li><span class="math inline">\(Y_i\)</span> es <strong>una medida imperfecta</strong> de una variable no observable, <span class="math inline">\(\eta_i\)</span>.</li>
<li><span class="math inline">\(\varepsilon_i\)</span> recibe el nombre de <strong>unicidad</strong> (i.e., varianza no explicada).
<ul>
<li>Una parte de la <strong>unicidad</strong> es el <strong>error de medida</strong></li>
</ul></li>
<li>Es habitual contar con <strong>varias medidas de la variable no observable</strong>.</li>
<li>Este mismo modelo para <span class="math inline">\(I\)</span> personas y <span class="math inline">\(J\)</span> variables observables es</li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
Y_{i\color{red}j} = \nu_\color{red}j + \lambda_\color{red}j \cdot \eta_i + \varepsilon_{i\color{red}j},\quad\text{donde}\quad\varepsilon_{i\color{red}j}\sim\mathcal{N}\left(\mu =0,\, \sigma = \theta_\color{red}j\right)
\]</span></p>
</div>
<ul>
<li class="fragment">¿Y si tenemos <strong>más de una variable latente</strong>?</li>
</ul>
</section>
<section id="el-modelo-psicométrico-del-factor-común-6" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<ul>
<li class="fragment">¿Cómo cambia el modelo al ir añadiendo variables latentes?</li>
</ul>
<div class="fragment">
<div style="float:left; margin-left: 70px; margin-top: -30px; margin-bottom: -20px">
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \varepsilon_{ij}\\
\end{aligned}
\]</span></p>
</div>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-7" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<div>
<ul>
<li>¿Cómo cambia el modelo al ir añadiendo variables latentes?</li>
</ul>
</div>
<div style="float:left; margin-left: 70px; margin-top: -30px; margin-bottom: -20px">
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \color{royalblue}\eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \varepsilon_{ij}\\
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-8" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<div>
<ul>
<li>¿Cómo cambia el modelo al ir añadiendo variables latentes?</li>
</ul>
</div>
<div style="float:left; margin-left: 70px; margin-top: -30px; margin-bottom: -20px">
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \color{seagreen}{\lambda_{j3} \cdot \eta_{i3}} + \varepsilon_{ij}\\
\end{aligned}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-9" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<div>
<ul>
<li>¿Cómo cambia el modelo al ir añadiendo variables latentes?</li>
</ul>
</div>
<div style="float:left; margin-left: 70px; margin-top: -30px; margin-bottom: -20px">
<p><span class="math display">\[
\begin{aligned}
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \color{seagreen}{\lambda_{j3} \cdot \eta_{i3}} + \varepsilon_{ij}\\
&amp; Y_{ij} = \nu_j + \color{royalblue}{\lambda_{j1} \cdot \eta_{i1}} + \color{firebrick}{\lambda_{j2} \cdot \eta_{i2}} + \color{seagreen}{\lambda_{j3} \cdot \eta_{i3}} + \dots + \varepsilon_{ij}\\
\end{aligned}
\]</span></p>
</div>
<ul>
<li class="fragment">Cuando hay <span class="math inline">\(M\)</span> variables latentes, el modelo se puede escribir como</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
Y_{ij} = \nu_j + \sum^ \color{red}M_{ \color{red}m=1} \lambda_{j \color{red}m} \cdot \eta_{i \color{red}m} + \varepsilon_{ij}
\]</span></p>
</div>
</section>
<section id="el-modelo-psicométrico-del-factor-común-10" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<ul>
<li class="fragment">Los psicómetras prefieren la <strong>versión matricial</strong> del modelo.</li>
</ul>
<div style="margin-top: -30px; margin-bottom: -20px">
<div class="fragment">
<p><span class="math display">\[
\underbrace{
\begin{bmatrix}
Y_{i1}\\
Y_{i2}\\
Y_{i3}\\
\end{bmatrix}}_{\textstyle{\mathbf{y}_i}} =
\underbrace{
\begin{bmatrix}
\nu_{1}\\
\nu_{2}\\
\nu_{3}\\
\end{bmatrix}}_{\textstyle{\boldsymbol{\nu}}} +
\underbrace{
\begin{bmatrix}
\lambda_{11} &amp; \lambda_{12}\\
\lambda_{21} &amp; \lambda_{22}\\
\lambda_{31} &amp; \lambda_{32}\\
\end{bmatrix}}_{\textstyle{\mathbf{\Lambda}}} \times
\underbrace{
\begin{bmatrix}
\eta_{i1}\\
\eta_{i2}\\
\end{bmatrix}}_{\textstyle{\boldsymbol{\eta}_i}} +
\underbrace{
\begin{bmatrix}
\varepsilon_{1}\\
\varepsilon_{2}\\
\varepsilon_{3}\\
\end{bmatrix}}_{\textstyle{\boldsymbol{\varepsilon}_i}}
\]</span></p>
</div>
</div>
<ul>
<li class="fragment">En la <strong>versión matricial</strong>, para cada sujeto <span class="math inline">\(i\)</span> tenemos:
<ul>
<li class="fragment">Un vector con <span class="math inline">\(J\)</span> respuestas observadas: <span class="math inline">\(\mathbf{y}_i\)</span>.</li>
<li class="fragment">Un vector con <span class="math inline">\(J\)</span> intersecciones: <span class="math inline">\(\boldsymbol\nu\)</span>.</li>
<li class="fragment">Una matriz con <span class="math inline">\(J\times M\)</span> pesos factoriales: <span class="math inline">\(\mathbf{\Lambda}\)</span>.</li>
<li class="fragment">Un vector con <span class="math inline">\(M\)</span> puntuaciones latentes: <span class="math inline">\(\boldsymbol\eta_i\)</span>.</li>
<li class="fragment">Un vector con <span class="math inline">\(J\)</span> puntuaciones error: <span class="math inline">\(\boldsymbol{\varepsilon}_i\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="el-modelo-psicométrico-del-factor-común-11" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<ul>
<li class="fragment">Ambas versiones representan <strong>dos formas distintas</strong> del mismo modelo</li>
<li class="fragment">La versión <strong>condicional</strong></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\color{seagreen}{Y_{ij}} \sim \color{#7E57C2}{\mathcal{N}}\left(\color{#9a2515}\mu = \color{#0197FD}{\nu_j + \sum^M_{m=1}\lambda_{jm} \cdot \eta_{im}},\,\color{#9a2515}\sigma = \color{#0197FD}{\theta}\right)
\]</span></p>
</div>
<ul>
<li class="fragment">La versión <strong>marginal</strong></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
</div>
<ul>
<li class="fragment"><span class="math inline">\(\boldsymbol{\alpha}\)</span> es el vector con las medias de <span class="math inline">\(\boldsymbol{\eta}_i\)</span>. <span class="math inline">\(\mathbf\Psi\)</span> y <span class="math inline">\(\mathbf\Theta\)</span> son las matrices de covarianzas de <span class="math inline">\(\boldsymbol{\eta}_i\)</span> y <span class="math inline">\(\boldsymbol{\varepsilon}_i\)</span>, respectivamente.</li>
</ul>
</section>
<section id="el-modelo-psicométrico-del-factor-común-12" class="slide level2">
<h2>El modelo psicométrico del factor común</h2>
<div>
<ul>
<li>Ambas versiones representan <strong>dos formas distintas</strong> del mismo modelo</li>
<li>La versión <strong>condicional</strong></li>
</ul>
</div>
<p><span class="math display">\[
Y_{ij} \sim \mathcal{N}\left(\mu = \nu_j + \sum^M_{m=1}\lambda_{jm} \cdot \color{firebrick}{\eta_{im}},\,\sigma = \theta\right)
\]</span></p>
<div>
<ul>
<li>La versión <strong>marginal</strong></li>
</ul>
</div>
<p><span class="math display">\[
\mathbf{y}_i  \sim \mathcal{MVN}\left(\boldsymbol\mu = \boldsymbol\nu + \mathbf{\Lambda} \cdot \color{firebrick}{\boldsymbol{\alpha}},\,\mathbf{\Sigma} =  \mathbf{\Lambda\cdot\color{firebrick}{\mathbf\Psi}\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}\right)
\]</span></p>
<div>
<ul>
<li><span class="math inline">\(\boldsymbol{\alpha}\)</span> es el vector con las medias de <span class="math inline">\(\boldsymbol{\eta}_i\)</span>. <span class="math inline">\(\mathbf\Psi\)</span> y <span class="math inline">\(\mathbf\Theta\)</span> son las matrices de covarianzas de <span class="math inline">\(\boldsymbol{\eta}_i\)</span> y <span class="math inline">\(\boldsymbol{\varepsilon}_i\)</span>, respectivamente.</li>
</ul>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Modelo sin estructura de medias</strong></p>
</div>
<div class="fragment">
<p><img data-src="Images/SEM_without_means_qrt.png"></p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Modelo con estructura de medias</strong></p>
</div>
<div class="fragment">
<p><img data-src="Images/SEM_with_means_qrt.png"></p>
</div>
</div></div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-1" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">Intersecciones de los ítems: <span class="math inline">\(\boldsymbol{\nu}\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\boldsymbol{\nu} = \left[-1,\,0,\,1,\,-1,\,0,\,1\right]
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="co"># Vector de intersecciones poblacional</span></span>
<span id="cb35-2"><a href=""></a>Nu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-2" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">Pesos factoriales no estandarizados: <span class="math inline">\(\mathbf{\Lambda}\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mathbf{\Lambda}^\prime=\begin{bmatrix}
1.40 &amp; 1.75 &amp; 2.10 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1.40 &amp; 1.75 &amp; 2.10 \\
\end{bmatrix}
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a>Lambda <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.40</span>, <span class="fl">1.75</span>, <span class="fl">2.10</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb36-2"><a href=""></a>                   <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.40</span>, <span class="fl">1.75</span>, <span class="fl">2.10</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb36-3"><a href=""></a><span class="fu">t</span>(Lambda) <span class="co"># Lambda transpuesta </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]  1.4 1.75  2.1  0.0 0.00  0.0
[2,]  0.0 0.00  0.0  1.4 1.75  2.1</code></pre>
</div>
</div>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-3" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">Medias de las variables latentes: <span class="math inline">\(\boldsymbol{\alpha}\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\boldsymbol{\alpha} = \left[0,\,0\right]
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="co"># Medias latentes poblacionales</span></span>
<span id="cb38-2"><a href=""></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-4" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">Matriz de covarianzas entre las variables latentes: <span class="math inline">\(\mathbf{\Psi}\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mathbf{\Psi} = \begin{bmatrix}
1 &amp; 0.5\\
0.5 &amp; 1
\end{bmatrix}
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="co"># Matriz de covarianzas latente poblacional</span></span>
<span id="cb39-2"><a href=""></a>Psi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-5" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">Matriz de varianzas únicas: <span class="math inline">\(\mathbf{\Theta}\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mathbf{\Theta}=\begin{bmatrix}
\theta^2_{11} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \theta^2_{22} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \theta^2_{33} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; \theta^2_{44}  &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \theta^2_{55} &amp;  0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \theta^2_{66}\\
\end{bmatrix}
\]</span></p>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-6" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<div>
<ul>
<li>Matriz de varianzas únicas: <span class="math inline">\(\mathbf{\Theta}\)</span></li>
</ul>
</div>
<p><span class="math display">\[
\mathbf{\Theta}=\begin{bmatrix}
2.04 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 3.1875 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 4.59 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 2.04  &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 3.1875 &amp;  0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 4.59\\
\end{bmatrix}
\]</span></p>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-7" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<div>
<ul>
<li>Matriz de varianzas únicas: <span class="math inline">\(\mathbf{\Theta}\)</span></li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="co"># Matriz de covarianzas únicas poblacional</span></span>
<span id="cb40-2"><a href=""></a>(Theta <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">2.04</span>, <span class="fl">3.1875</span>, <span class="fl">4.59</span>, <span class="fl">2.04</span>, <span class="fl">3.1875</span>, <span class="fl">4.59</span>), <span class="dv">6</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2] [,3] [,4]   [,5] [,6]
[1,] 2.04 0.0000 0.00 0.00 0.0000 0.00
[2,] 0.00 3.1875 0.00 0.00 0.0000 0.00
[3,] 0.00 0.0000 4.59 0.00 0.0000 0.00
[4,] 0.00 0.0000 0.00 2.04 0.0000 0.00
[5,] 0.00 0.0000 0.00 0.00 3.1875 0.00
[6,] 0.00 0.0000 0.00 0.00 0.0000 4.59</code></pre>
</div>
</div>
</section>
<section id="simulando-datos-desde-el-modelo-en-r-8" class="slide level2">
<h2>Simulando datos desde el modelo en <code>R</code></h2>
<p><span class="math display">\[
\color{seagreen}{\mathbf{y}_i}  \sim \color{#7E57C2}{\mathcal{MVN}}\left(\color{#9a2515}{\boldsymbol\mu} = \color{#0197FD}{\boldsymbol\nu + \mathbf{\Lambda} \cdot \boldsymbol{\alpha}},\,\color{#9a2515}{\mathbf{\Sigma}} =  \color{#0197FD}{\mathbf{\Lambda\cdot\mathbf\Psi\cdot\mathbf{\Lambda}^\prime + \mathbf{\Theta}}}\right)
\]</span></p>
<ul>
<li class="fragment">¡Ahora podemos calcular <span class="math inline">\(\color{#9a2515}{\boldsymbol\mu}\)</span> y <span class="math inline">\(\color{#9a2515}{\mathbf{\Sigma}}\)</span> tal y como indica el modelo!</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="|1-2|3|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="co"># Parámetros del modelo multivariante</span></span>
<span id="cb42-2"><a href=""></a>mu <span class="ot">&lt;-</span> Nu    <span class="co"># Como alpha = 0, Lambda * alpha = 0.</span></span>
<span id="cb42-3"><a href=""></a>Sigma <span class="ot">=</span> Lambda <span class="sc">%*%</span> Psi <span class="sc">%*%</span> <span class="fu">t</span>(Lambda) <span class="sc">+</span> Theta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Finalmente, simulamos las respuesta de <span class="math inline">\(n=300\)</span> participantes.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb43" data-code-line-numbers="1-3|4|5|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="co"># Simulamos datos desde el modelo</span></span>
<span id="cb43-2"><a href=""></a><span class="fu">library</span>(MASS) <span class="co"># Tiene la distribución normal multivariante</span></span>
<span id="cb43-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2025</span>) <span class="co"># Simulación reproducible</span></span>
<span id="cb43-4"><a href=""></a>Y <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">300</span>, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma)</span>
<span id="cb43-5"><a href=""></a>Y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Y) <span class="co"># Guardamos como data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section>
<section>
<section id="estimación-a-través-de-blavaan" class="title-slide slide level1 center">
<h1>Estimación a través de <code>{blavaan}</code></h1>

</section>
<section id="sintaxis-del-modelo" class="slide level2">
<h2>Sintaxis del modelo</h2>
<ul>
<li class="fragment">La sintaxis de <code>{blavaan}</code> es idéntica a la de <code>{lavaan}</code>.</li>
<li class="fragment">Especificaremos dos modelos: uno con <strong>un único factor</strong> común y otro con <strong>dos factores relacionados</strong> (el verdadero).</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="co"># Sintaxis del modelo: un factor común</span></span>
<span id="cb44-2"><a href=""></a>model<span class="fl">.1</span>f <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb44-3"><a href=""></a><span class="st">F1 =~ V1 + V2 + V3 + V4 + V5 + V6</span></span>
<span id="cb44-4"><a href=""></a><span class="st">'</span></span>
<span id="cb44-5"><a href=""></a><span class="co"># Sintaxis del modelo: dos factores relacionados</span></span>
<span id="cb44-6"><a href=""></a>model<span class="fl">.2</span>f <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb44-7"><a href=""></a><span class="st">F1 =~ V1 + V2 + V3</span></span>
<span id="cb44-8"><a href=""></a><span class="st">F2 =~ V4 + V5 + V6</span></span>
<span id="cb44-9"><a href=""></a><span class="st">F1 ~~ F2</span></span>
<span id="cb44-10"><a href=""></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prior-predictive-check" class="slide level2">
<h2>Prior predictive check</h2>
<ul>
<li class="fragment">¿Qué priors está utilizando <code>{blavaan}</code> para los parámetros del modelo?</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a><span class="co"># By-default prior distributions</span></span>
<span id="cb45-2"><a href=""></a><span class="fu">dpriors</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<caption>Distribución a priori de los parámetros del CFA</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Parámetro</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">priors</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Parámetro</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">priors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">\(\nu\)</td>
<td style="text-align: center;">normal(0,32)</td>
<td style="text-align: center;">\(\theta\)</td>
<td style="text-align: center;">gamma(1,.5)[sd]</td>
</tr>
<tr class="even">
<td style="text-align: center;">\(\alpha\)</td>
<td style="text-align: center;">normal(0,10)</td>
<td style="text-align: center;">\(\psi\)</td>
<td style="text-align: center;">gamma(1,.5)[sd]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">\(\lambda\)</td>
<td style="text-align: center;">normal(0,10)</td>
<td style="text-align: center;">\(\rho\)</td>
<td style="text-align: center;">beta(1,1)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="prior-predictive-check-1" class="slide level2">
<h2>Prior predictive check</h2>
<ul>
<li class="fragment"><code>{blavaan}</code> tiene un atajo para realizar <strong>prior predictive checks</strong>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb46" data-code-line-numbers="|1-2|3|4|5|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="co"># Ajusta un modelo "vacío" prisamp = TRUE!</span></span>
<span id="cb46-2"><a href=""></a>prior_predictive <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(model<span class="fl">.2</span>f, <span class="at">data =</span> Y, <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb46-3"><a href=""></a>                         <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, <span class="at">test =</span> <span class="st">"none"</span>, </span>
<span id="cb46-4"><a href=""></a>                         <span class="at">sample =</span> <span class="fl">2e4</span>, <span class="at">prisamp =</span> <span class="cn">TRUE</span>, </span>
<span id="cb46-5"><a href=""></a>                         <span class="at">bcontrol =</span> <span class="fu">list</span>(<span class="at">cores =</span> <span class="dv">3</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Acto seguido, podemos guardar la <strong>distribución a priori</strong> con la siguiente línea de código</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="co"># Guardamos la distribución a priori</span></span>
<span id="cb47-2"><a href=""></a>prior.draws <span class="ot">&lt;-</span> <span class="fu">blavInspect</span>(prior_predictive, <span class="st">"mcmc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Graficaremos las distribuciones con el paquete <code>{bayesplot}</code></li>
</ul>
</section>
<section id="prior-predictive-check-intersecciones" class="slide level2">
<h2>Prior predictive check: intersecciones</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="co"># Prior predictive distribution: intersecciones</span></span>
<span id="cb48-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> prior.draws, <span class="at">regex_pars =</span> <span class="st">"~1"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-56-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-pesos-factoriales" class="slide level2">
<h2>Prior predictive check: pesos factoriales</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="co"># Prior predictive distribution: pesos factoriales</span></span>
<span id="cb49-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> prior.draws, <span class="at">regex_pars =</span> <span class="st">"=~"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-58-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-correlaciones-latentes" class="slide level2">
<h2>Prior predictive check: correlaciones latentes</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a><span class="co"># Prior predictive distribution: correlación latente</span></span>
<span id="cb50-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> prior.draws, <span class="at">pars =</span> <span class="st">"F1~~F2"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-60-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-varianzas-únicas" class="slide level2">
<h2>Prior predictive check: varianzas únicas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="co"># Prior predictive distribution: correlación latente</span></span>
<span id="cb51-2"><a href=""></a>pars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"~~"</span>, <span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb51-3"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> prior.draws, <span class="at">pars =</span> pars,  <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-62-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="cambiando-la-distribución-prior" class="slide level2">
<h2>Cambiando la distribución prior</h2>
<ul>
<li class="fragment"><strong>En</strong> <code>{blavaan}</code> <strong>no se puede cambiar la distribución a priori, sólo sus parámetros.</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb52" data-code-line-numbers="|1-2|3|4|5|10|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a><span class="co"># Nueva distribución a priori</span></span>
<span id="cb52-2"><a href=""></a>(new_priors <span class="ot">&lt;-</span> <span class="fu">dpriors</span>(<span class="at">nu =</span> <span class="st">"normal(0,15)"</span>, </span>
<span id="cb52-3"><a href=""></a>                       <span class="at">lambda =</span> <span class="st">"normal(0,5)"</span>, </span>
<span id="cb52-4"><a href=""></a>                       <span class="at">rho =</span> <span class="st">"beta(2,2)"</span>, </span>
<span id="cb52-5"><a href=""></a>                       <span class="at">psi =</span> <span class="st">"gamma(1,.2)"</span>))</span>
<span id="cb52-6"><a href=""></a><span class="co"># Muestreamos de la nueva distribución a priori</span></span>
<span id="cb52-7"><a href=""></a>new_prior_pred <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(model<span class="fl">.2</span>f, <span class="at">data =</span> Y, <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-8"><a href=""></a>                       <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, <span class="at">test =</span> <span class="st">"none"</span>, </span>
<span id="cb52-9"><a href=""></a>                       <span class="at">sample =</span> <span class="fl">2e4</span>, <span class="at">prisamp =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-10"><a href=""></a>                       <span class="at">dp =</span> new_priors, <span class="co"># Added new priors</span></span>
<span id="cb52-11"><a href=""></a>                       <span class="at">bcontrol =</span> <span class="fu">list</span>(<span class="at">cores =</span> <span class="dv">3</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="cambiando-la-distribución-prior-1" class="slide level2">
<h2>Cambiando la distribución prior</h2>
<ul>
<li class="fragment">Volvemos a extraer la distribución a priori</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a>new.prior.draws <span class="ot">&lt;-</span> <span class="fu">blavInspect</span>(new_prior_pred, <span class="st">"mcmc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prior-predictive-check-intersecciones-1" class="slide level2">
<h2>Prior predictive check: intersecciones</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a><span class="co"># Prior predictive distribution: intersecciones</span></span>
<span id="cb54-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> new.prior.draws, <span class="at">regex_pars =</span> <span class="st">"~1"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-67-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-pesos-factoriales-1" class="slide level2">
<h2>Prior predictive check: pesos factoriales</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a><span class="co"># Prior predictive distribution: pesos factoriales</span></span>
<span id="cb55-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> new.prior.draws, <span class="at">regex_pars =</span> <span class="st">"=~"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-69-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-correlaciones-latentes-1" class="slide level2">
<h2>Prior predictive check: correlaciones latentes</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="co"># Prior predictive distribution: correlación latente</span></span>
<span id="cb56-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> new.prior.draws, <span class="at">pars =</span> <span class="st">"F1~~F2"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-71-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="prior-predictive-check-varianzas-únicas-1" class="slide level2">
<h2>Prior predictive check: varianzas únicas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a><span class="co"># Prior predictive distribution: correlación latente</span></span>
<span id="cb57-2"><a href=""></a>pars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"~~"</span>, <span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb57-3"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> new.prior.draws, <span class="at">pars =</span> pars,  <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-73-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="estimación-del-modelo" class="slide level2">
<h2>Estimación del modelo</h2>
<ul>
<li class="fragment"><p>Estimaremos los modelos de uno y dos factores <strong>con las nuevas priors.</strong></p></li>
<li class="fragment"><p>Utilizaremos <strong>3 cadenas de Markov</strong> con <strong>1500 iteraciones</strong>, descartando las primeras 500 iteraciones.</p></li>
<li class="fragment"><p><code>bcontrol</code> permite <strong>paralelizar</strong> las cadenas de Markov.</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb58" data-code-line-numbers="|1-2|3|4|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="co"># Modelo de un factor</span></span>
<span id="cb58-2"><a href=""></a>bcfa<span class="fl">.1</span>f.fit <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(model<span class="fl">.1</span>f, <span class="at">data =</span> Y, <span class="at">burnin =</span> <span class="dv">500</span>, </span>
<span id="cb58-3"><a href=""></a>                    <span class="at">sample =</span> <span class="dv">1000</span>, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, </span>
<span id="cb58-4"><a href=""></a>                    <span class="at">std.lv =</span> <span class="cn">TRUE</span>, <span class="at">bcontrol =</span> <span class="fu">list</span>(<span class="at">cores =</span> <span class="dv">3</span>))</span>
<span id="cb58-5"><a href=""></a><span class="co"># Modelo de dos factores</span></span>
<span id="cb58-6"><a href=""></a>bcfa<span class="fl">.2</span>f.fit <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(model<span class="fl">.2</span>f, <span class="at">data =</span> Y, <span class="at">burnin =</span> <span class="dv">500</span>, </span>
<span id="cb58-7"><a href=""></a>                    <span class="at">sample =</span> <span class="dv">1000</span>, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, </span>
<span id="cb58-8"><a href=""></a>                    <span class="at">std.lv =</span> <span class="cn">TRUE</span>, <span class="at">bcontrol =</span> <span class="fu">list</span>(<span class="at">cores =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="convergencia-del-modelo" class="slide level2">
<h2>Convergencia del modelo</h2>
<ul>
<li class="fragment">La <strong>validez</strong> de las inferencias depende de la <strong>convergencia</strong> del modelo.</li>
<li class="fragment"><em>Potential Scale Reduction Factor</em> (PSRF, <span class="math inline">\(\hat R\)</span>) con valores inferiores a 1.05</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="co"># Potential Scale Reduction Factor (PSRF): 1 factor</span></span>
<span id="cb59-2"><a href=""></a><span class="fu">which</span>(<span class="fu">blavInspect</span>(bcfa<span class="fl">.1</span>f.fit, <span class="at">what =</span> <span class="st">"rhat"</span>) <span class="sc">&gt;</span> <span class="fl">1.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a><span class="co"># Potential Scale Reduction Factor (PSRF): 2 factores</span></span>
<span id="cb61-2"><a href=""></a><span class="fu">which</span>(<span class="fu">blavInspect</span>(bcfa<span class="fl">.2</span>f.fit, <span class="at">what =</span> <span class="st">"rhat"</span>) <span class="sc">&gt;</span> <span class="fl">1.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Esto sugiere que las cadenas de Markov <strong>están muestreando de la misma distribución posterior de manera estable.</strong></li>
</ul>
</section>
<section id="convergencia-del-modelo-1" class="slide level2">
<h2>Convergencia del modelo</h2>
<ul>
<li class="fragment">Podemos <strong>evaluar visualmente la convergencia de las cadenas de Markov</strong> a través de los gráficos de trayectoria (<strong>traceplots</strong>).</li>
<li class="fragment">Para ello, necesitamos <strong>extraer la distribución posterior</strong> de los parámetros.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href=""></a><span class="co"># Distribución posterior de ambos modelos</span></span>
<span id="cb63-2"><a href=""></a>posterior<span class="fl">.1</span>f <span class="ot">&lt;-</span> <span class="fu">blavInspect</span>(bcfa<span class="fl">.1</span>f.fit, <span class="st">"mcmc"</span>)</span>
<span id="cb63-3"><a href=""></a>posterior<span class="fl">.2</span>f <span class="ot">&lt;-</span> <span class="fu">blavInspect</span>(bcfa<span class="fl">.2</span>f.fit, <span class="st">"mcmc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">El siguiente código genera <strong>traceplots</strong> para los pesos factoriales</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a><span class="co"># Gráficos de trayectoria</span></span>
<span id="cb64-2"><a href=""></a><span class="fu">mcmc_trace</span>(<span class="at">x =</span> posterior<span class="fl">.1</span>f, <span class="at">regex_pars =</span> <span class="st">"F1=~"</span>)</span>
<span id="cb64-3"><a href=""></a><span class="fu">mcmc_trace</span>(<span class="at">x =</span> posterior<span class="fl">.2</span>f, <span class="at">regex_pars =</span> <span class="fu">c</span>(<span class="st">"F1=~"</span>, <span class="st">"F2=~"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="convergencia-del-modelo-2" class="slide level2">
<h2>Convergencia del modelo</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-79-1.png" width="960" class="r-stretch"></section>
<section id="convergencia-del-modelo-3" class="slide level2">
<h2>Convergencia del modelo</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-80-1.png" width="960" class="r-stretch"></section>
<section id="convergencia-del-modelo-4" class="slide level2">
<h2>Convergencia del modelo</h2>
<ul>
<li class="fragment">Podemos destacar una de las cadenas para evaluar su desempeño.</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href=""></a><span class="fu">mcmc_trace_highlight</span>(<span class="at">x =</span> posterior<span class="fl">.2</span>f, <span class="at">regex_pars =</span> <span class="st">"F1~~F2"</span>, </span>
<span id="cb65-2"><a href=""></a>                     <span class="at">highlight =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-82-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="convergencia-del-modelo-5" class="slide level2">
<h2>Convergencia del modelo</h2>
<ul>
<li class="fragment">¿Qué aspecto tiene este gráfico cuando <strong>la convergencia es mala</strong>?</li>
</ul>
<div class="fragment">
<p><img data-src="Images/badchains2.png"></p>
</div>
</section>
<section id="eficiencia" class="slide level2">
<h2>Eficiencia</h2>
<ul>
<li class="fragment">Los valores de los parámetros de iteración a iteración suelen estar correlacionados.</li>
<li class="fragment">Cuanto <strong>menor sea su correlación</strong>, <strong>más informativo será el valor</strong> en cada muestra.</li>
<li class="fragment">Se evalúa a través del <strong>tamaño muestral efectivo</strong>.
<ul>
<li class="fragment">Valor mínimo recomendable: <span class="math inline">\(100\times\)</span> Nº de cadenas de Markov.</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a><span class="fu">min</span>(<span class="fu">blavInspect</span>(bcfa<span class="fl">.1</span>f.fit, <span class="st">"neff"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 947.9307</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href=""></a><span class="fu">min</span>(<span class="fu">blavInspect</span>(bcfa<span class="fl">.2</span>f.fit, <span class="st">"neff"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2093.932</code></pre>
</div>
</div>
</div>
</section>
<section id="ajuste-del-modelo" class="slide level2">
<h2>Ajuste del modelo</h2>
<ul>
<li class="fragment">Similares a los índices de ajuste frecuentistas, ¡pero <strong>con intervalos de credibilidad</strong>!</li>
<li class="fragment"><strong>Índices Bayesianos de ajuste global</strong>
<ul>
<li class="fragment"><em>Bayesian Root Mean Square Error of Approximation</em> (BRMSEA)</li>
<li class="fragment"><em>Bayesian Unbiased Goodnes-of-fit Index</em> (<span class="math inline">\(\Gamma\)</span>)</li>
<li class="fragment"><em>Bayesian Unbiased Goodnes-of-fit Index</em> ajustado a muestras pequeñas (<span class="math inline">\(\Gamma_{adj}\)</span>)</li>
<li class="fragment"><em>Bayesian McDonald Index</em> (BMc)</li>
</ul></li>
<li class="fragment"><strong>Índices Bayesianos de ajuste incremental</strong>
<ul>
<li class="fragment"><em>Bayesian Comparative Fit Index</em> (BCFI)</li>
<li class="fragment"><em>Bayesian Tucker-Lewis Index</em> (BTLI)</li>
</ul></li>
</ul>
</section>
<section id="ajuste-del-modelo-1" class="slide level2">
<h2>Ajuste del modelo</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Índices de ajuste incremental en <code>{blavaan}</code></strong></p>
</div>
<div class="callout-content">
<p>Los índices de ajuste incremental bayesianos, <strong>BCFI</strong> y <strong>BTLI</strong>, comparan el ajuste del modelo propuesto con el de un modelo nulo. Sin embargo, <code>{blavaan}</code> <strong>no estima ese modelo nulo</strong> por defecto, como sí hace <code>{lavaan}</code>. Por ello, debemos especificar manualmente el modelo nulo y estimarlo.</p>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb70" data-code-line-numbers="|1-2|3-6|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href=""></a><span class="co"># Sintaxis del modelo nulo</span></span>
<span id="cb70-2"><a href=""></a>model.null <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">"~~"</span>,<span class="st">"V"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">collapse =</span> <span class="st">" </span><span class="sc">\n</span><span class="st"> "</span>)</span>
<span id="cb70-3"><a href=""></a><span class="co"># Ajustamos el modelo nulo</span></span>
<span id="cb70-4"><a href=""></a>bcfa.null.fit <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(model.null, <span class="at">data =</span> Y, <span class="at">burnin =</span> <span class="dv">500</span>, </span>
<span id="cb70-5"><a href=""></a>                      <span class="at">sample =</span> <span class="dv">1000</span>, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, </span>
<span id="cb70-6"><a href=""></a>                      <span class="at">std.lv =</span> <span class="cn">TRUE</span>, <span class="at">bcontrol =</span> <span class="fu">list</span>(<span class="at">cores =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="ajuste-del-modelo-un-factor-común" class="slide level2">
<h2>Ajuste del modelo: un factor común</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" data-code-line-numbers="|1-2|3|4-5|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href=""></a><span class="co"># Indices de ajuste: un factor</span></span>
<span id="cb71-2"><a href=""></a>blav_fit_1f <span class="ot">&lt;-</span> <span class="fu">blavFitIndices</span>(<span class="at">object =</span> bcfa<span class="fl">.1</span>f.fit, </span>
<span id="cb71-3"><a href=""></a>                              <span class="at">baseline.model =</span> bcfa.null.fit)</span>
<span id="cb71-4"><a href=""></a><span class="fu">summary</span>(blav_fit_1f, <span class="at">hpd =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> .<span class="dv">95</span>,</span>
<span id="cb71-5"><a href=""></a>        <span class="at">central.tendency =</span> <span class="fu">c</span>(<span class="st">"mean"</span>,<span class="st">"median"</span>,<span class="st">"mode"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               EAP Median   MAP    SD  lower upper
BRMSEA       0.313  0.313 0.312 0.007  0.301 0.327
BGammaHat    0.873  0.874 0.874 0.005  0.864 0.882
adjBGammaHat 0.228  0.230 0.235 0.030  0.169 0.282
BMc          0.804  0.805 0.806 0.008  0.789 0.818
BCFI         0.714  0.715 0.716 0.013  0.688 0.738
BTLI         0.052  0.056 0.059 0.044 -0.035 0.131
BNFI         0.714  0.715 0.716 0.013  0.688 0.737</code></pre>
</div>
</div>
</div>
</section>
<section id="ajuste-del-modelo-un-factor-común-1" class="slide level2">
<h2>Ajuste del modelo: un factor común</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="fu">data.frame</span>(blav_fit_1f<span class="sc">@</span>indices), <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb73-2"><a href=""></a>          <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"BRMSEA"</span>, <span class="st">"BCFI"</span>, <span class="st">"BTLI"</span>, <span class="st">"BGammaHat"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-89-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="ajuste-del-modelo-dos-factores-correlacionados" class="slide level2">
<h2>Ajuste del modelo: dos factores correlacionados</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a><span class="co"># Indices de ajuste: dos factores</span></span>
<span id="cb74-2"><a href=""></a>blav_fit_2f <span class="ot">&lt;-</span> <span class="fu">blavFitIndices</span>(<span class="at">object =</span> bcfa<span class="fl">.2</span>f.fit, </span>
<span id="cb74-3"><a href=""></a>                              <span class="at">baseline.model =</span> bcfa.null.fit)</span>
<span id="cb74-4"><a href=""></a><span class="fu">summary</span>(blav_fit_2f, <span class="at">hpd =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> .<span class="dv">95</span>,</span>
<span id="cb74-5"><a href=""></a>        <span class="at">central.tendency =</span> <span class="fu">c</span>(<span class="st">"mean"</span>,<span class="st">"median"</span>,<span class="st">"mode"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               EAP Median   MAP    SD lower upper
BRMSEA       0.046  0.050 0.057 0.026 0.000 0.085
BGammaHat    0.993  0.993 1.000 0.006 0.981 1.000
adjBGammaHat 0.975  0.978 0.998 0.021 0.936 1.000
BMc          0.989  0.990 0.999 0.009 0.972 1.000
BCFI         0.985  0.987 0.999 0.012 0.962 1.000
BTLI         0.974  0.976 0.983 0.024 0.924 1.017
BNFI         0.969  0.970 0.974 0.013 0.943 0.992</code></pre>
</div>
</div>
</div>
</section>
<section id="ajuste-del-modelo-dos-factores-correlacionados-1" class="slide level2">
<h2>Ajuste del modelo: dos factores correlacionados</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="fu">data.frame</span>(blav_fit_2f<span class="sc">@</span>indices), <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb76-2"><a href=""></a>          <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"BRMSEA"</span>, <span class="st">"BCFI"</span>, <span class="st">"BTLI"</span>, <span class="st">"BGammaHat"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-93-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="comparación-de-modelos" class="slide level2">
<h2>Comparación de modelos</h2>
<ul>
<li class="fragment"><code>{blavaan}</code> incluye dos métodos para comparar modelos:</li>
</ul>
<ol type="1">
<li class="fragment">Métodos basados en la <strong>capacidad predictiva del modelo:</strong>
<ul>
<li class="fragment"><em>Leave-One-Out</em> (LOO) <em>cross-validation</em>.</li>
<li class="fragment"><em>Watanabee-Akaike Information Criteria</em> (WAIC).</li>
<li class="fragment">Ambos incluidos en el paquete <code>{loo}</code>.</li>
<li class="fragment">Cuentan con <strong>pruebas de significacion.</strong></li>
</ul></li>
<li class="fragment">Métodos basados en la <strong>capacidad explicativa del modelo:</strong>
<ul>
<li class="fragment">Factor de Bayes (aproximación de Laplace-Metrópolis).</li>
<li class="fragment"><code>{blavaan}</code> no recomienda su uso.</li>
</ul></li>
</ol>
</section>
<section id="comparación-de-modelos-1" class="slide level2">
<h2>Comparación de modelos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77" data-code-line-numbers="|1-3|4-6|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href=""></a><span class="co"># Comparación de modelos</span></span>
<span id="cb77-2"><a href=""></a>blav_com_1f_2f <span class="ot">&lt;-</span> <span class="fu">blavCompare</span>(<span class="at">object1 =</span> bcfa<span class="fl">.1</span>f.fit, </span>
<span id="cb77-3"><a href=""></a>                              <span class="at">object2 =</span> bcfa<span class="fl">.2</span>f.fit)</span>
<span id="cb77-4"><a href=""></a><span class="co"># Leave-One-Out: </span></span>
<span id="cb77-5"><a href=""></a>blav_com_1f_2f<span class="sc">$</span>loo[[<span class="dv">1</span>]] <span class="co"># modelo de un factor</span></span>
<span id="cb77-6"><a href=""></a>blav_com_1f_2f<span class="sc">$</span>loo[[<span class="dv">2</span>]] <span class="co"># modelo de dos factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Un factor
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dos factores
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estimación</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Error típico</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estimación</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Error típico</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">elpd_loo</td>
<td style="text-align: center;">-4048.296</td>
<td style="text-align: center;">34.544</td>
<td style="text-align: center;">-3984.390</td>
<td style="text-align: center;">32.102</td>
</tr>
<tr class="even">
<td style="text-align: left;">p_loo</td>
<td style="text-align: center;">22.568</td>
<td style="text-align: center;">1.663</td>
<td style="text-align: center;">18.993</td>
<td style="text-align: center;">1.202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">looic</td>
<td style="text-align: center;">8096.592</td>
<td style="text-align: center;">69.087</td>
<td style="text-align: center;">7968.780</td>
<td style="text-align: center;">64.204</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="comparación-de-modelos-2" class="slide level2">
<h2>Comparación de modelos</h2>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a><span class="co"># Comparación de ELPDs</span></span>
<span id="cb78-2"><a href=""></a>blav_com_1f_2f<span class="sc">$</span>diff_loo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff
model2   0.0       0.0  
model1 -63.9      12.2  </code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment"><code>Model2</code> es el modelo que hemos indicado previamente en <code>object 2</code></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href=""></a><span class="co"># Comparación de modelos</span></span>
<span id="cb80-2"><a href=""></a>blav_com_1f_2f <span class="ot">&lt;-</span> <span class="fu">blavCompare</span>(<span class="at">object1 =</span> bcfa<span class="fl">.1</span>f.fit, </span>
<span id="cb80-3"><a href=""></a>                              <span class="at">object2 =</span> bcfa<span class="fl">.2</span>f.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Por tanto, <strong>el modelo de dos factores tiene mejor capacidad predictiva que el de un factor</strong> porque la diferencia <span class="math inline">\(\Delta\mbox{ELPD} = -63.9\)</span> está fuera del rango <span class="math inline">\(\pm 2 \times 12.2\)</span>.</li>
</ul>
</section>
<section id="estimaciones-de-los-parámetros-medias-posteriores" class="slide level2">
<h2>Estimaciones de los parámetros: medias posteriores</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href=""></a><span class="fu">parameterEstimates</span>(bcfa<span class="fl">.2</span>f.fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, </span>
<span id="cb81-2"><a href=""></a>                   <span class="at">output =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Latent Variables:
                   Estimate   Std.lv  Std.all
  F1 =~                                      
    V1                1.452    1.452    0.711
    V2                2.091    2.091    0.759
    V3                2.031    2.031    0.673
  F2 =~                                      
    V4                1.566    1.566    0.722
    V5                1.671    1.671    0.708
    V6                1.905    1.905    0.667

Covariances:
                   Estimate   Std.lv  Std.all
  F1 ~~                                      
    F2                0.469    0.469    0.469

Intercepts:
                   Estimate   Std.lv  Std.all
   .V1               -1.086   -1.086   -0.532
   .V2               -0.013   -0.013   -0.005
   .V3                1.029    1.029    0.341
   .V4               -0.918   -0.918   -0.423
   .V5                0.041    0.041    0.017
   .V6                0.986    0.986    0.345
    F1                0.000    0.000    0.000
    F2                0.000    0.000    0.000

Variances:
                   Estimate   Std.lv  Std.all
   .V1                2.060    2.060    0.494
   .V2                3.218    3.218    0.424
   .V3                4.974    4.974    0.547
   .V4                2.247    2.247    0.478
   .V5                2.779    2.779    0.499
   .V6                4.538    4.538    0.556
    F1                1.000    1.000    1.000
    F2                1.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="distribución-posterior-intersecciones" class="slide level2">
<h2>Distribución posterior: intersecciones</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href=""></a><span class="co"># Posterior distribution: histograms</span></span>
<span id="cb83-2"><a href=""></a><span class="fu">mcmc_hist</span>(<span class="at">x =</span> posterior<span class="fl">.2</span>f, <span class="at">regex_pars =</span> <span class="st">"~1"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-101-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="distribución-posterior-correlación-latente" class="slide level2">
<h2>Distribución posterior: correlación latente</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href=""></a><span class="co"># Posterior distribution: density plot</span></span>
<span id="cb84-2"><a href=""></a><span class="fu">mcmc_dens</span>(<span class="at">x =</span> posterior<span class="fl">.2</span>f, <span class="at">pars =</span> <span class="st">"F1~~F2"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-103-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="distribución-posterior-pesos-factoriales" class="slide level2">
<h2>Distribución posterior: pesos factoriales</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href=""></a><span class="co"># Posterior distribution: pairs plots</span></span>
<span id="cb85-2"><a href=""></a><span class="fu">mcmc_pairs</span>(posterior<span class="fl">.2</span>f, <span class="at">regex_pars =</span> <span class="st">"F1=~"</span>, <span class="at">diag_fun =</span> <span class="st">"hist"</span>, </span>
<span id="cb85-3"><a href=""></a>           <span class="at">off_diag_fun =</span> <span class="st">"scatter"</span>, <span class="at">off_diag_args =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-105-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="distribución-posterior-varianzas-únicas" class="slide level2">
<h2>Distribución posterior: varianzas únicas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href=""></a><span class="co"># Posterior distribution: pairs plots</span></span>
<span id="cb86-2"><a href=""></a><span class="fu">mcmc_intervals</span>(posterior<span class="fl">.2</span>f, <span class="at">pars =</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"~~"</span>, <span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-107-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="distribución-posterior-pesos-factoriales-1" class="slide level2">
<h2>Distribución posterior: pesos factoriales</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href=""></a><span class="co"># Posterior distribution: pairs plots</span></span>
<span id="cb87-2"><a href=""></a><span class="fu">mcmc_areas</span>(posterior<span class="fl">.2</span>f, <span class="at">regex_pars =</span> <span class="fu">c</span>(<span class="st">"F1=~"</span>, <span class="st">"F2=~"</span>),</span>
<span id="cb87-3"><a href=""></a>  <span class="at">prob =</span> <span class="fl">0.8</span>, <span class="at">prob_outer =</span> <span class="fl">0.95</span>, <span class="at">point_est =</span> <span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-109-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="posterior-predictive-model-checks-ppmc" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC)</h2>
<ul>
<li class="fragment">Método para evaluar la capacidad predictiva de un modelo.</li>
<li class="fragment">La idea central es <strong>verificar si el model puede generar datos similares a los datos observados.</strong></li>
<li class="fragment">¿Podemos distinguir los <strong>datos observados</strong> de <strong>datos simulados desde el modelo</strong>?</li>
<li class="fragment">En <code>{blavaan}</code> podemos utilizar la función <code>sampleData</code> para generar datos desde el modelo.</li>
<li class="fragment">Tras simularlo, se <strong>comparan gráficamente</strong> los datos observados y simulados</li>
</ul>
</section>
<section id="posterior-predictive-model-checks-ytextrep" class="slide level2">
<h2>Posterior Predictive Model Checks: <span class="math inline">\(y^{\text{rep}}\)</span></h2>
<ul>
<li class="fragment">Finalmente, podemos ver el parecido entre <span class="math inline">\(y\)</span> con <span class="math inline">\(y^{\text{rep}}\)</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb88" data-code-line-numbers="|1-2|3-4|5|6-8|9|11-12|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href=""></a><span class="co"># Simulamos 100 bases de datos</span></span>
<span id="cb88-2"><a href=""></a>yrep <span class="ot">&lt;-</span> <span class="fu">sampleData</span>(bcfa<span class="fl">.2</span>f.fit, <span class="at">nrep =</span> <span class="dv">100</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href=""></a><span class="co"># Guardamos los resultados para cada item</span></span>
<span id="cb88-4"><a href=""></a>posterior_plots_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">ncol</span>(Y))</span>
<span id="cb88-5"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Y)){</span>
<span id="cb88-6"><a href=""></a>  posterior_plots_list[[i]] <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(</span>
<span id="cb88-7"><a href=""></a>    <span class="at">y =</span> Y[,i], <span class="at">yrep =</span> <span class="fu">t</span>(<span class="fu">sapply</span>(yrep, <span class="cf">function</span>(x) x[,i]))</span>
<span id="cb88-8"><a href=""></a>    ) <span class="sc">+</span> </span>
<span id="cb88-9"><a href=""></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Item"</span>, i))</span>
<span id="cb88-10"><a href=""></a>}</span>
<span id="cb88-11"><a href=""></a><span class="co"># Gráfico comparando y e yrep</span></span>
<span id="cb88-12"><a href=""></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> posterior_plots_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ytextrep-1" class="slide level2">
<h2>Posterior Predictive Model Checks: <span class="math inline">\(y^{\text{rep}}\)</span></h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-111-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="posterior-predictive-model-checks-ppmc-1" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC)</h2>
<ul>
<li class="fragment">El PPMC también puede aplicarse a estadísticos específicos (SRMR, <span class="math inline">\(\chi^2\)</span>).</li>
<li class="fragment">Durante la estimación, en cada iteración:
<ol type="1">
<li class="fragment">Se <strong>extrae una muestra</strong> de los parámetros <span class="math inline">\(\theta^{(s)}\)</span> de la <strong>distribución posterior</strong> (esto lo hacemos <strong>siempre</strong>).</li>
<li class="fragment">Se utilizan estos parámetros para <strong>generar datos simulados</strong>: <span class="math inline">\(y^{\text{rep}}\)</span>.</li>
<li class="fragment">Se <strong>calcula algún estadístico</strong> de interés en <span class="math inline">\(y^{\text{rep}}\)</span> e <span class="math inline">\(y\)</span>.</li>
<li class="fragment">Se <strong>compara la distribución del estadístico</strong> entre <span class="math inline">\(y\)</span> e <span class="math inline">\(y^{\text{rep}}\)</span>.</li>
</ol></li>
<li class="fragment">En <code>{blavaan}</code> pueden realizarse con la función <code>ppmc</code></li>
</ul>
</section>
<section id="posterior-predictive-model-checks-ppmc-2" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC)</h2>
<ul>
<li class="fragment">En el modelo bayesiano, en cada iteracion:
<ul>
<li class="fragment">Estimamos <span class="math inline">\(\mathbf{\Lambda}^{(s)}\)</span>, <span class="math inline">\(\mathbf{\Theta}^{(s)}\)</span> y <span class="math inline">\(\mathbf{\Psi}^{(s)}\)</span>.</li>
<li class="fragment">Estimamos <span class="math inline">\(\mathbf{\Sigma}^{(s)} = \mathbf{\Lambda}^{(s)}\cdot\mathbf{\Psi}^{(s)}\cdot\mathbf{\Lambda}^{\prime(s)} + \mathbf{\Theta}^{(s)}\)</span>.</li>
<li class="fragment">Siempre tenemos la misma matriz de covarianzas observada: <span class="math inline">\(\mbox{Cov}\left(Y\right)\)</span>.</li>
<li class="fragment">Calculamos el estadístico <span class="math inline">\(\chi^{2(s)}\)</span>, que refleja la discrepancia entre <span class="math inline">\(\mbox{Cov}\left(Y\right)\)</span> y <span class="math inline">\(\mathbf{\Sigma}^{(s)}\)</span>.</li>
<li class="fragment">Simulamos <span class="math inline">\(y^{rep(s)} \sim \mathcal{MVN}\left(\boldsymbol{\mu}^{(s)}, \mathbf{\Sigma}^{(s)}\right)\)</span></li>
<li class="fragment">Calculamos la media y covarianza “observada” de <span class="math inline">\(y^{rep(s)}\)</span>.</li>
<li class="fragment">Calculamos el estadístico <span class="math inline">\(\chi^{2(s),rep}\)</span>, que refleja la discrepancia entre <span class="math inline">\(\mbox{Cov}\left(y^{rep(s)}\right)\)</span> y <span class="math inline">\(\mathbf{\Sigma}^{(s)}\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="posterior-predictive-model-checks-ppmc-chi2-y-srmr" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): <span class="math inline">\(\chi^2\)</span> y SRMR</h2>
<ul>
<li class="fragment">La función <code>ppmc</code> puede utilizarse para calcular el estadístico <span class="math inline">\(\chi^2\)</span> y SRMR en los datos observados y simulados en cada iteración.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb89" data-code-line-numbers="|1-2|3|4-5|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href=""></a><span class="co"># Posterior Predictive Model Checks</span></span>
<span id="cb89-2"><a href=""></a>ppmc_fit_1f <span class="ot">&lt;-</span> <span class="fu">ppmc</span>(<span class="at">object =</span> bcfa<span class="fl">.1</span>f.fit, <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb89-3"><a href=""></a>                    <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">"srmr"</span>,<span class="st">"chisq"</span>))</span>
<span id="cb89-4"><a href=""></a>ppmc_fit_2f <span class="ot">&lt;-</span> <span class="fu">ppmc</span>(<span class="at">object =</span> bcfa<span class="fl">.2</span>f.fit, <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb89-5"><a href=""></a>                    <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">"srmr"</span>,<span class="st">"chisq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Las funciones <code>plot</code> e <code>hist</code> comparan gráficamente los datos observados y simulados.</li>
</ul>
</section>
<section id="posterior-predictive-model-checks-ppmc-chi2" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): <span class="math inline">\(\chi^2\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href=""></a><span class="fu">plot</span>(ppmc_fit_2f, <span class="at">element =</span> <span class="st">"chisq"</span>) <span class="co"># Dos factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-115-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-chi2-1" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): <span class="math inline">\(\chi^2\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href=""></a><span class="fu">hist</span>(ppmc_fit_2f, <span class="at">element =</span> <span class="st">"chisq"</span>) <span class="co"># Dos factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-117-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-chi2-2" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): <span class="math inline">\(\chi^2\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href=""></a><span class="fu">plot</span>(ppmc_fit_1f, <span class="at">element =</span> <span class="st">"chisq"</span>) <span class="co"># Un factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-119-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-chi2-3" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): <span class="math inline">\(\chi^2\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href=""></a><span class="fu">hist</span>(ppmc_fit_1f, <span class="at">element =</span> <span class="st">"chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-121-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-srmr" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): SRMR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href=""></a><span class="fu">plot</span>(ppmc_fit_2f, <span class="at">element =</span> <span class="st">"srmr"</span>) <span class="co"># Dos factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-123-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-srmr-1" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): SRMR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href=""></a><span class="fu">hist</span>(ppmc_fit_2f, <span class="at">element =</span> <span class="st">"srmr"</span>) <span class="co"># Dos factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-125-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-srmr-2" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): SRMR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href=""></a><span class="fu">plot</span>(ppmc_fit_1f, <span class="at">element =</span> <span class="st">"srmr"</span>) <span class="co"># Un factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-127-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks-ppmc-srmr-3" class="slide level2">
<h2>Posterior Predictive Model Checks (PPMC): SRMR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href=""></a><span class="fu">hist</span>(ppmc_fit_1f, <span class="at">element =</span> <span class="st">"srmr"</span>) <span class="co"># Un factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-129-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ppmc-y-fiabilidad-omega" class="slide level2">
<h2>PPMC y Fiabilidad: <span class="math inline">\(\omega\)</span></h2>
<ul>
<li class="fragment">Podemos utilizar <code>ppmc</code> con <strong><u>cualquier función que pueda utilizarse para un modelo de <code>{lavaan}</code></u>.</strong></li>
<li class="fragment">Podemos utilizar <code>compRelSEM</code> de <code>{SemTools}</code> para obtener la distribución posterior de <span class="math inline">\(\omega\)</span>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb98" data-code-line-numbers="|1-2|3-5|6-8|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href=""></a><span class="co"># Función para obtener la fiabilidad en cada iteración</span></span>
<span id="cb98-2"><a href=""></a>bcfa.reliability <span class="ot">&lt;-</span> <span class="cf">function</span>(fit){ semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(fit) }</span>
<span id="cb98-3"><a href=""></a><span class="co"># Fiabilidad en el modelo unidimensional</span></span>
<span id="cb98-4"><a href=""></a>ppmc_omega_1f <span class="ot">&lt;-</span> <span class="fu">ppmc</span>(<span class="at">object =</span> blavaan<span class="fl">.1</span>f.fit, </span>
<span id="cb98-5"><a href=""></a>                      <span class="at">discFUN =</span> bcfa.reliability)</span>
<span id="cb98-6"><a href=""></a><span class="co"># Fiabilidad en el modelo de dos factores</span></span>
<span id="cb98-7"><a href=""></a>ppmc_omega_2f <span class="ot">&lt;-</span> <span class="fu">ppmc</span>(<span class="at">object =</span> blavaan<span class="fl">.2</span>f.fit, </span>
<span id="cb98-8"><a href=""></a>                      <span class="at">discFUN =</span> bcfa.reliability)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="ppmc-y-fiabilidad-omega-1" class="slide level2">
<h2>PPMC y Fiabilidad: <span class="math inline">\(\omega\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href=""></a><span class="co"># Distribución posterior de la fiabilidad: un factor</span></span>
<span id="cb99-2"><a href=""></a><span class="fu">hist</span>(<span class="fu">unlist</span>(posterior_omega_1f<span class="sc">@</span>obsDist<span class="sc">$</span>discFUN1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-132-1.png" width="960" class="r-stretch"></section>
<section id="ppmc-y-fiabilidad-omega-2" class="slide level2">
<h2>PPMC y Fiabilidad: <span class="math inline">\(\omega\)</span></h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-133-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="estimación-a-través-de-stan-y-cmdstanr" class="title-slide slide level1 center">
<h1>Estimación a través de Stan y <code>{cmdstanr}</code></h1>

</section>
<section id="stan-state-of-the-art" class="slide level2">
<h2>Stan: state of the art</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">Stan representa el <em>state of the art</em> de la estadística bayesiana.</li>
<li class="fragment">Algoritmo Monte Carlo Hamiltoniano más eficiente: el <em>No-U-Turn Sampler</em> (NUTS)</li>
<li class="fragment">Le debe su nombre a <strong>Stanislaw Marcin Ulam</strong>,
<ul>
<li class="fragment">Matemático polaco, miembro del <strong>proyecto Manhattan</strong></li>
<li class="fragment"><strong>Co-autor del método de Montecarlo.</strong></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><img data-src="Images/ulam.jpg"></p>
</div>
</div></div>
</section>
<section id="stan-state-of-the-art-1" class="slide level2">
<h2>Stan: state of the art</h2>
<ul>
<li class="fragment">En <code>R</code>, podemos usar <code>{Rstan}</code> o <code>{cmdstanr}</code>.</li>
<li class="fragment">Es <strong>muy recomendable</strong> utilizar <code>{cmdstanr}</code>:
<ol type="1">
<li class="fragment">La elección de los creadores de Stan.</li>
<li class="fragment">Sólo <code>{cmdstanr}</code> utiliza la <strong>última versión de Stan.</strong></li>
<li class="fragment">Evita saturaciones en la memoria RAM.</li>
<li class="fragment"><strong>Más rápido y eficiente</strong> en la estimación.</li>
<li class="fragment">Conectado con otros paquetes: <code>{posterior}</code>, <code>{loo}</code>, <code>{bayesplot}</code>…</li>
</ol></li>
<li class="fragment">De hecho, es <strong>más fácil</strong> instalar Stan usando <code>{cmdstanr}.</code></li>
</ul>
</section>
<section id="programación-en-stan." class="slide level2">
<h2>Programación en Stan.</h2>
<ul>
<li class="fragment">Puede hacerse en <code>Rstudio</code>.</li>
<li class="fragment">Cuenta con <strong>siete</strong> posibles bloques:
<ol type="1">
<li class="fragment"><strong>Functions</strong>: espacio para crear funciones específicas.</li>
<li class="fragment"><strong>Data</strong>: se introducen los datos desde <code>R</code> como una lista.</li>
<li class="fragment"><strong>Transformed data</strong>: transformaciones sobre los datos introducidos.</li>
<li class="fragment"><strong>Parameters</strong>: parámetros que muestrearemos de la posterior.</li>
<li class="fragment"><strong>Transformed parameters</strong>: transformaciones sobre los parámetros muestreados.</li>
<li class="fragment"><strong>Model</strong>: priors y log-verosimilitud.</li>
<li class="fragment"><strong>Generated quantities</strong>: parámetros transformados post-estimación.</li>
</ol></li>
</ul>
</section>
<section id="programación-en-stan.-1" class="slide level2">
<h2>Programación en Stan.</h2>
<div class="sourceCode" id="cb100" data-code-line-numbers="|1-4|5-8|9-12|13-16|17-20|21-24|25-28|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb100-1"><a href=""></a><span class="co">// Espacio para funciones</span></span>
<span id="cb100-2"><a href=""></a><span class="kw">functions</span> {</span>
<span id="cb100-3"><a href=""></a>  </span>
<span id="cb100-4"><a href=""></a>}</span>
<span id="cb100-5"><a href=""></a><span class="co">// Espacio para los datos</span></span>
<span id="cb100-6"><a href=""></a><span class="kw">data</span> {</span>
<span id="cb100-7"><a href=""></a>  </span>
<span id="cb100-8"><a href=""></a>}</span>
<span id="cb100-9"><a href=""></a><span class="co">// Espacio para transformar los datos</span></span>
<span id="cb100-10"><a href=""></a><span class="kw">transformed data</span> {</span>
<span id="cb100-11"><a href=""></a></span>
<span id="cb100-12"><a href=""></a>}</span>
<span id="cb100-13"><a href=""></a><span class="co">// Espacio para los parámetros</span></span>
<span id="cb100-14"><a href=""></a><span class="kw">parameters</span> {</span>
<span id="cb100-15"><a href=""></a></span>
<span id="cb100-16"><a href=""></a>}</span>
<span id="cb100-17"><a href=""></a><span class="co">// Espacio para los parámetros transformados</span></span>
<span id="cb100-18"><a href=""></a><span class="kw">transformed parameters</span> {</span>
<span id="cb100-19"><a href=""></a></span>
<span id="cb100-20"><a href=""></a>}</span>
<span id="cb100-21"><a href=""></a><span class="co">// Espacio para el modelo</span></span>
<span id="cb100-22"><a href=""></a><span class="kw">model</span> {</span>
<span id="cb100-23"><a href=""></a></span>
<span id="cb100-24"><a href=""></a>}</span>
<span id="cb100-25"><a href=""></a><span class="co">// Espacio para las cantidades generadas</span></span>
<span id="cb100-26"><a href=""></a><span class="kw">generated quantities</span>{</span>
<span id="cb100-27"><a href=""></a></span>
<span id="cb100-28"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="programación-en-stan-data" class="slide level2">
<h2>Programación en Stan: Data</h2>
<ul>
<li class="fragment">Programaremos el código para un <strong>modelo factorial confirmatorio.</strong></li>
<li class="fragment">Los datos necesarios son:
<ol type="1">
<li class="fragment">Número de participantes: <span class="math inline">\(N\)</span></li>
<li class="fragment">Número de ítems: <span class="math inline">\(J\)</span></li>
<li class="fragment">Número de latentes: <span class="math inline">\(M\)</span></li>
<li class="fragment">Matriz con los datos observados: <span class="math inline">\(Y\)</span></li>
<li class="fragment">Matriz que indique qué item satura en qué factor.</li>
</ol></li>
<li class="fragment">Esta es <strong>mi forma de hacerlo</strong>, pero hay infinitas versiones alternativas!</li>
</ul>
</section>
<section id="programación-en-stan-data-1" class="slide level2">
<h2>Programación en Stan: Data</h2>
<div class="sourceCode" id="cb101" data-code-line-numbers="|2|3|4|5|6|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb101-1"><a href=""></a><span class="kw">data</span> {</span>
<span id="cb101-2"><a href=""></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N;             <span class="co">// Number of observations</span></span>
<span id="cb101-3"><a href=""></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; J;             <span class="co">// Number of items</span></span>
<span id="cb101-4"><a href=""></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; M;             <span class="co">// Number of latent factors</span></span>
<span id="cb101-5"><a href=""></a>  <span class="dt">matrix</span>[N, J] Y;             <span class="co">// Observed data</span></span>
<span id="cb101-6"><a href=""></a>  <span class="dt">matrix</span>[J, M] L_ind;         <span class="co">// Lambda index matrix</span></span>
<span id="cb101-7"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="programación-en-stan-parámetros" class="slide level2">
<h2>Programación en Stan: Parámetros</h2>
<ul>
<li class="fragment">Vamos a especificar que el modelo muestree
<ol type="1">
<li class="fragment">El <strong>vector de medias</strong> del modelo: <span class="math inline">\(\boldsymbol\mu\)</span>.</li>
<li class="fragment">La <strong>matriz de pesos factoriales</strong>: <span class="math inline">\(\mathbf{\Lambda}\)</span>.</li>
<li class="fragment">El <strong>vector de varianzas únicas</strong>: <span class="math inline">\(\boldsymbol\theta\)</span>.</li>
<li class="fragment">La <strong>matriz triangular inferior</strong> de la descomposición de Cholesky para las correlaciones latentes: <span class="math inline">\(L_\boldsymbol\Psi\)</span>
<ul>
<li class="fragment">Garantiza que la matriz de correlaciones es válida</li>
<li class="fragment">Recuperamos <span class="math inline">\(\boldsymbol\Psi\)</span> como <span class="math inline">\(\boldsymbol\Psi=L_\boldsymbol\Psi\cdot L_\boldsymbol\Psi^\prime\)</span></li>
</ul></li>
</ol></li>
</ul>
</section>
<section id="programación-en-stan-parámetros-1" class="slide level2">
<h2>Programación en Stan: Parámetros</h2>
<div>
<ul>
<li>Vamos a especificar que el modelo muestree
<ol type="1">
<li>El <strong>vector de medias</strong> del modelo: <span class="math inline">\(\boldsymbol\mu\)</span>.</li>
<li>La <strong>matriz de pesos factoriales</strong>: <span class="math inline">\(\mathbf{\Lambda}\)</span>.</li>
<li>El <strong>vector de varianzas únicas</strong>: <span class="math inline">\(\boldsymbol\theta\)</span>.</li>
<li>La <strong>matriz triangular inferior</strong> de la <strong>descomposición de Cholesky</strong> para las correlaciones latentes: <span class="math inline">\(L_\boldsymbol\Psi\)</span>.</li>
</ol></li>
</ul>
</div>
<div class="fragment">
<div class="sourceCode" id="cb102" data-code-line-numbers="|2|3|4|5|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb102-1"><a href=""></a><span class="kw">parameters</span> {</span>
<span id="cb102-2"><a href=""></a>  <span class="dt">vector</span>[J] mu;</span>
<span id="cb102-3"><a href=""></a>  <span class="dt">matrix</span>[J, M] L_unc;</span>
<span id="cb102-4"><a href=""></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt;[J] Theta;</span>
<span id="cb102-5"><a href=""></a>  <span class="dt">cholesky_factor_corr</span>[M] Psi_chol;</span>
<span id="cb102-6"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="programación-en-stan-parámetros-transformados" class="slide level2">
<h2>Programación en Stan: Parámetros transformados</h2>
<ol type="1">
<li class="fragment">Indicar qué peso va con cada factor latente.</li>
<li class="fragment">Construir <span class="math inline">\(\mathbf{\Psi}\)</span> como <span class="math inline">\(L_\mathbf{\Psi}\cdot L_\mathbf{\Psi}^\prime\)</span>.</li>
<li class="fragment">Construir <span class="math inline">\(\mathbf{\Sigma}\)</span> como <span class="math inline">\(\mathbf{\Sigma} = \mathbf{\Lambda}\cdot\mathbf{\Psi}\cdot\mathbf{\Lambda}^\prime+\mathbf{\Theta}\)</span> .</li>
</ol>
<div class="fragment">
<div class="sourceCode" id="cb103" data-code-line-numbers="|2-3|4-5|6-8|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb103-1"><a href=""></a><span class="kw">transformed parameters</span>{</span>
<span id="cb103-2"><a href=""></a>  <span class="co">// Constrain Lambda matrix</span></span>
<span id="cb103-3"><a href=""></a>  <span class="dt">matrix</span>[J, M] L_mat = L_unc .* L_ind;</span>
<span id="cb103-4"><a href=""></a>  <span class="co">// Model-implied latent-variable correlation matrix</span></span>
<span id="cb103-5"><a href=""></a>  <span class="dt">corr_matrix</span>[M] Psi_b = Psi_chol + Psi_chol';</span>
<span id="cb103-6"><a href=""></a>  <span class="co">// Model-implied covariance matrix</span></span>
<span id="cb103-7"><a href=""></a>  <span class="dt">cov_matrix</span>[J] Sigma;</span>
<span id="cb103-8"><a href=""></a>  Sigma = L_mat * Psi_b * L_mat' + diag_matrix(Theta);</span>
<span id="cb103-9"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="programación-en-stan-modelo" class="slide level2">
<h2>Programación en Stan: Modelo</h2>
<ul>
<li class="fragment">Sólo debemos <strong>poner priors</strong> en los <strong>parámetros muestreados</strong>.</li>
<li class="fragment">En este ejemplo usaremos priors poco informativas.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
&amp;\boldsymbol\mu\sim\mbox{Normal}\left(\mu = 0,\,\, \sigma = 10\right)\\
&amp;\mathbf\Lambda\sim\mbox{Normal}\left(\mu = 0,\,\, \sigma = 5\right)\\
&amp;\boldsymbol\theta\sim\mbox{Gamma}\left(\alpha = 1,\,\, \beta = 0.5\right)\\
&amp;L_\Psi\sim\mbox{LkjCholesky}\left(\eta=1\right)\\
\end{aligned}
\]</span></p>
</div>
<ul>
<li class="fragment">Finalmente, especificaremos la <strong>función de verosimilitud</strong> del modelo.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mathbf{y}_i\sim\mathcal{MVN}\left(\boldsymbol\mu,\,\,\mathbf{\Sigma}\right)
\]</span></p>
</div>
</section>
<section id="programación-en-stan-modelo-1" class="slide level2">
<h2>Programación en Stan: Modelo</h2>
<div class="sourceCode" id="cb104" data-code-line-numbers="|2-3|4|5|6|8-11|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb104-1"><a href=""></a><span class="kw">model</span> {</span>
<span id="cb104-2"><a href=""></a>  <span class="co">// Model priors</span></span>
<span id="cb104-3"><a href=""></a>  mu ~ normal(<span class="dv">0</span>, <span class="dv">10</span>);              <span class="co">// Mu prior</span></span>
<span id="cb104-4"><a href=""></a>  to_vector(L_unc) ~ normal(<span class="dv">0</span>, <span class="dv">5</span>); <span class="co">// Lambda prior</span></span>
<span id="cb104-5"><a href=""></a>  Theta ~ gamma(<span class="dv">1</span>, <span class="fl">0.5</span>);           <span class="co">// Theta prior</span></span>
<span id="cb104-6"><a href=""></a>  Psi_chol ~ lkj_corr_cholesky(<span class="dv">1</span>); <span class="co">// Psi prior</span></span>
<span id="cb104-7"><a href=""></a>  </span>
<span id="cb104-8"><a href=""></a>  <span class="co">// Model log-likelihood</span></span>
<span id="cb104-9"><a href=""></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb104-10"><a href=""></a>    Y[i,] ~ multi_normal(mu, Sigma);</span>
<span id="cb104-11"><a href=""></a>  }</span>
<span id="cb104-12"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="programación-en-stan-cantidades-generadas" class="slide level2">
<h2>Programación en Stan: Cantidades generadas</h2>
<ul>
<li class="fragment">Este apartado permite realizar <strong>cálculos tras ajustar el modelo.</strong>
<ul>
<li class="fragment">Otras transformaciones de parámetros.</li>
<li class="fragment">Simulación de datos (<span class="math inline">\(y^{\text{rep}}\)</span>)</li>
<li class="fragment">Posterior Predictive Model Checks</li>
<li class="fragment">Cálculo de log-verosimilitudes</li>
</ul></li>
<li class="fragment">Nosotros <strong>guardaremos la log-verosimilitud</strong> para comparar modelos.</li>
</ul>
<div class="fragment">
<div class="sourceCode" id="cb105" data-code-line-numbers="|2|3-5|"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb105-1"><a href=""></a><span class="kw">generated quantities</span> {</span>
<span id="cb105-2"><a href=""></a>  <span class="dt">vector</span>[N] log_lik;          <span class="co">// Model log-likelihood</span></span>
<span id="cb105-3"><a href=""></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb105-4"><a href=""></a>    log_lik[i] = multi_normal_lpdf(Y[i,] | mu, Sigma);</span>
<span id="cb105-5"><a href=""></a>  }</span>
<span id="cb105-6"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="programación-en-stan-cantidades-generadas-1" class="slide level2">
<h2>Programación en Stan: Cantidades generadas</h2>
<ul>
<li class="fragment">El modelo estima los parámetros <span class="math inline">\(\boldsymbol\mu\)</span> y <span class="math inline">\(\mathbf\Sigma\)</span> en función de los datos, <span class="math inline">\(y\)</span>.</li>
<li class="fragment">Sin embargo, podemos obtener <strong>la misma</strong> <span class="math inline">\(\mathbf\Sigma\)</span> <strong>con distintas</strong> <span class="math inline">\(\mathbf\Lambda\)</span>:
<ul>
<li class="fragment">Obtendríamos la misma <span class="math inline">\(\mathbf\Sigma\)</span> usando <span class="math inline">\(\mathbf\Lambda\)</span> o <span class="math inline">\(-\mathbf\Lambda\)</span>.</li>
</ul></li>
<li class="fragment"><code>{blavaan}</code> soluciona este problema de signos en las cantidades generadas.</li>
<li class="fragment">El código de este modelo incluye esta corrección.
<ul>
<li class="fragment">No lo mostraremos en detalle, basta con saber que se aplica para que el modelo esté identificado.</li>
</ul></li>
</ul>
</section>
<section id="usando-cmdstanr" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<ul>
<li class="fragment">El primer paso es <strong>compilar</strong> nuestro modelo programado en <strong>Stan</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href=""></a><span class="co"># Compilamos el modelo</span></span>
<span id="cb106-2"><a href=""></a>BCFA <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"CFA_marginal.stan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment">Una vez compilado, <code>{cmdstanr}</code> creará un <strong>programa ejecutable</strong> en vuestro ordenador.</li>
<li class="fragment">Al mismo tiempo, tendremos acceso a este <strong>programa</strong> con el objeto donde hayamos guardado el modelo en <code>R</code>.</li>
<li class="fragment">El objeto <code>BCFA</code> es <strong>una especie de lista con todas las funciones que pueden utilizarse dentro.</strong></li>
</ul>
</section>
<section id="usando-cmdstanr-1" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<ul>
<li class="fragment">Por ejemplo, <code>BCFA$sample()</code> es la función para estimar el modelo bayesiano.</li>
<li class="fragment">Para <strong>introducir los datos</strong> en el modelo, <strong>utilizaremos una lista.</strong></li>
<li class="fragment">Los objetos de la lista <strong>deben coincidir en nombre con los del apartado de Datos en Stan</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href=""></a>sdata<span class="fl">.1</span>f <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb107-2"><a href=""></a>  <span class="at">N =</span> <span class="dv">300</span>,</span>
<span id="cb107-3"><a href=""></a>  <span class="at">J =</span> <span class="dv">6</span>,</span>
<span id="cb107-4"><a href=""></a>  <span class="at">M =</span> <span class="dv">1</span>,</span>
<span id="cb107-5"><a href=""></a>  <span class="at">Y =</span> Y,</span>
<span id="cb107-6"><a href=""></a>  <span class="at">L_ind =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb107-7"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="usando-cmdstanr-2" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<ul>
<li class="fragment"><code>BCFA$sample()</code> cuenta con muchos argumentos, pero no son similares a los de <code>{blavaan}</code></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href=""></a>BCFA_1f <span class="ot">&lt;-</span> BCFA<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb108-2"><a href=""></a>  <span class="at">data =</span> sdata<span class="fl">.1</span>f,       <span class="co"># Stan data</span></span>
<span id="cb108-3"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,            <span class="co"># Number of chains</span></span>
<span id="cb108-4"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,   <span class="co"># Number of parallel chains</span></span>
<span id="cb108-5"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">500</span>,     <span class="co"># Adaptation iterations</span></span>
<span id="cb108-6"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">1500</span>,  <span class="co"># Sampled iterations</span></span>
<span id="cb108-7"><a href=""></a>  <span class="at">refresh =</span> <span class="dv">500</span>,         <span class="co"># Progress bar at 500 iterations</span></span>
<span id="cb108-8"><a href=""></a>  <span class="at">init =</span> <span class="dv">0</span>)              <span class="co"># All starting values = 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li class="fragment"><code>BCFA-1f</code> será una lista que contenga los resultados y funciones para almacenarlos y resumirlos.</li>
</ul>
</section>
<section id="usando-cmdstanr-3" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<ul>
<li class="fragment">La función <code>BCFA_1f$summary()</code> genera tablas resumen de los parámetros que indiquemos.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href=""></a>BCFA_1f<span class="sc">$</span><span class="fu">summary</span>(<span class="st">"Lambda"</span>) <span class="co"># Estimated factor loadings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q95</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rhat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ess_bulk</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ess_tail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lambda[1,1]</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8877.06</td>
<td style="text-align: right;">5136.89</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[2,1]</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6893.36</td>
<td style="text-align: right;">5138.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambda[3,1]</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6140.56</td>
<td style="text-align: right;">4975.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[4,1]</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6879.88</td>
<td style="text-align: right;">4256.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambda[5,1]</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7426.89</td>
<td style="text-align: right;">4746.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[6,1]</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7576.66</td>
<td style="text-align: right;">4991.18</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="usando-cmdstanr-4" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<ul>
<li class="fragment">Estimaremos también el modelo de dos factores.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href=""></a>sdata<span class="fl">.2</span>f <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb110-2"><a href=""></a>  <span class="at">N =</span> <span class="dv">300</span>,</span>
<span id="cb110-3"><a href=""></a>  <span class="at">J =</span> <span class="dv">6</span>,</span>
<span id="cb110-4"><a href=""></a>  <span class="at">M =</span> <span class="dv">2</span>,</span>
<span id="cb110-5"><a href=""></a>  <span class="at">Y =</span> Y,</span>
<span id="cb110-6"><a href=""></a>  <span class="at">L_ind =</span> <span class="fu">ifelse</span>(Lambda <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb110-7"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="usando-cmdstanr-5" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<div>
<ul>
<li>Estimaremos también el modelo de dos factores.</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href=""></a>BCFA_2f <span class="ot">&lt;-</span> BCFA<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb111-2"><a href=""></a>  <span class="at">data =</span> sdata<span class="fl">.2</span>f,       <span class="co"># Stan data</span></span>
<span id="cb111-3"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,            <span class="co"># Number of chains</span></span>
<span id="cb111-4"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,   <span class="co"># Number of parallel chains</span></span>
<span id="cb111-5"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">500</span>,     <span class="co"># Adaptation iterations</span></span>
<span id="cb111-6"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">1500</span>,  <span class="co"># Sampled iterations</span></span>
<span id="cb111-7"><a href=""></a>  <span class="at">refresh =</span> <span class="dv">500</span>,         <span class="co"># Progress bar</span></span>
<span id="cb111-8"><a href=""></a>  <span class="at">seed =</span> <span class="dv">2025</span>,           <span class="co"># Reproducible results</span></span>
<span id="cb111-9"><a href=""></a>  <span class="at">init =</span> <span class="dv">0</span>)              <span class="co"># All starting values = 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="usando-cmdstanr-6" class="slide level2">
<h2>Usando <code>{cmdstanr}</code></h2>
<div>
<ul>
<li>Estimaremos también el modelo de dos factores.</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href=""></a>BCFA_2f<span class="sc">$</span><span class="fu">summary</span>(<span class="st">"Lambda"</span>) <span class="co"># Estimated factor loadings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q95</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rhat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ess_bulk</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ess_tail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lambda[1,1]</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6068.92</td>
<td style="text-align: right;">4459.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[2,1]</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4970.63</td>
<td style="text-align: right;">4170.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambda[3,1]</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4619.45</td>
<td style="text-align: right;">4105.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[4,2]</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5773.14</td>
<td style="text-align: right;">4878.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambda[5,2]</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5678.16</td>
<td style="text-align: right;">4705.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambda[6,2]</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5434.57</td>
<td style="text-align: right;">4405.27</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="comparando-modelos" class="slide level2">
<h2>Comparando modelos</h2>
<ul>
<li class="fragment">Hemos guardado la log-verosimilitud de ambos modelos.</li>
<li class="fragment">Podemos acceder a todos sus valores usando <code>$draws()</code></li>
<li class="fragment">Los utilizaremos para comparar los modelos con <code>{loo}</code></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href=""></a>loo_1f  <span class="ot">&lt;-</span> <span class="fu">loo</span>(<span class="at">x =</span> BCFA_1f<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"log_lik"</span>))</span>
<span id="cb113-2"><a href=""></a>loo_2f  <span class="ot">&lt;-</span> <span class="fu">loo</span>(<span class="at">x =</span> BCFA_2f<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"log_lik"</span>))</span>
<span id="cb113-3"><a href=""></a><span class="fu">loo_compare</span>(loo_1f, loo_2f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff
model2   0.0       0.0  
model1 -55.2      12.0  </code></pre>
</div>
</div>
</div>
</section></section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>

</section>

<section>
<section id="bonus-track-1-comparación-de-modelos" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Bonus track 1: Comparación de modelos</h1>

</section>
<section id="comparación-de-modelos-3" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Ojalá esto fuese más sencillo</strong></p>
</div>
<div class="callout-content">
<p>La comparación de modelos en estadística bayesiana ha sido (y sigue siendo) un tema de fervoroso debate entre dos disciplinas: <strong>los psicólogos matemáticos</strong> y <strong>los estadísticos bayesianos.</strong></p>
<div class="grid-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1em;">
<div class="fragment" data-fragment-index="1">
<u><strong>Psicólogos matemáticos</strong></u>
</div>
<div class="fragment" data-fragment-index="2">
<u><strong>Estadísticos bayesianos</strong></u>
</div>
<div class="fragment" data-fragment-index="3">
<strong>Objetivo <u>explicativo</u>:</strong> teorías cognitivas y conductuales como modelos cuantitativos.
</div>
<div class="fragment" data-fragment-index="4">
<strong>Objetivo <u>predictivo</u>:</strong> modelos empíricos con predicciones precisas.
</div>
<div class="fragment" data-fragment-index="5">
<strong>Comparación de modelos:</strong> métodos basados en la <strong><u>verosimilitud marginal</u></strong>.
</div>
<div class="fragment" data-fragment-index="6">
<strong>Comparación de modelos:</strong> métodos basados en la <strong><u>validación cruzada</u></strong>.
</div>
<div class="fragment" data-fragment-index="7">
<strong>Métodos de comparación:</strong> Factor de Bayes, <em>Bayesian Modelo Averaging</em>…
</div>
<div class="fragment" data-fragment-index="8">
<strong>Métodos de comparación:</strong> <em>Leave-One-Out cross-validation</em>, <em>Bayesian stacking</em>…
</div>
<div class="fragment" data-fragment-index="9">
<strong>Algoritmo MCMC:</strong> Suelen utilizar el <strong>sampleador de Gibbs</strong> (e.g., JAGS).
</div>
<div class="fragment" data-fragment-index="10">
<strong>Algoritmo MCMC:</strong> Suelen usar el algoritmo <strong>Monte Carlo Hamiltoniano</strong> (e.g., Stan).
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparación-de-modelos-el-factor-de-bayes" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos: el Factor de Bayes</h2>
<ul>
<li class="fragment">La <em>verosimilitud marginal</em> es <strong>la probabilidad de los datos observados</strong> con el modelo que hemos ajustado.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Pr\left(\theta \mid D\right) = \frac{\Pr\left(D \mid \theta\right) \times \Pr(\theta)}{\color{royalblue}{\Pr(D)}}
\]</span></p>
</div>
<ul>
<li class="fragment">El <strong>Factor de Bayes</strong> es la ratio entre la <em>verosimilitud marginal</em> de dos modelos <span class="math inline">\(\mathcal{M}\)</span>.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mbox{BF}_{12}=\frac{\color{royalblue}{\Pr(D\mid\mathcal{M}_1)}}{\color{royalblue}{\Pr(D\mid\mathcal{M}_2)}}
\]</span></p>
</div>
</section>
<section id="comparación-de-modelos-el-factor-de-bayes-1" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos: el Factor de Bayes</h2>
<p><span class="math display">\[
\mbox{BF}_{12}=\frac{\Pr(D\mid\mathcal{M}_1)}{\Pr(D\mid\mathcal{M}_2)}
\]</span></p>
<ul>
<li class="fragment">El Factor de Bayes <strong>compara la probabilidad de los datos observados en cada modelo.</strong></li>
<li class="fragment">Permite responder a la pregunta: <strong>¿Con qué modelo es más probable que se hayan generado los datos observados?.</strong></li>
<li class="fragment"><span class="math inline">\(\mbox{BF}_{12}=3\)</span> significa que <strong>los datos observados <u>son tres veces más probables</u></strong> con el modelo <span class="math inline">\(\mathcal{M}_1\)</span> que con <span class="math inline">\(\mathcal{M}_2\)</span>.</li>
<li class="fragment">Su cálculo exacto <strong>no está disponible en modelos complejos</strong>, pero <strong>puede aproximarse</strong> con métodos numéricos.</li>
</ul>
</section>
<section id="limitaciones-del-factor-de-bayes." class="slide level2" data-visibility="uncounted">
<h2>Limitaciones del factor de Bayes.</h2>
<ul>
<li class="fragment">Las críticas más relevantes contra el Factor de Bayes son:
<ol type="1">
<li class="fragment">Las aproximaciones pueden ser <strong>inestables y sesgadas</strong> en modelos complejos.</li>
<li class="fragment">Es <strong>muy sensible</strong> a las <strong>distribuciones a priori</strong>.</li>
<li class="fragment">Puede requerir <strong>muchas extracciones de la posterior</strong>.</li>
</ol></li>
<li class="fragment">Existen recomendaciones para:
<ol type="1">
<li class="fragment">Evaluar la inestabilidad y posible sesgo del Factor de Bayes.</li>
<li class="fragment">Evaluar el impacto de la distribución a priori.</li>
</ol></li>
</ul>
</section>
<section id="comparación-de-modelos-leave-one-out" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos: Leave-One-Out</h2>
<ul>
<li class="fragment">El método <em>Leave-One-Out</em> (LOO) evalúa la capacidad de un modelo para predecir datos que no fueron utilizados en su ajuste.</li>
<li class="fragment">Permite responder a la pregunta: <strong>¿Cómo de buenas son las predicciones del modelo fuera de la muestra original?</strong></li>
<li class="fragment">El procedimiento es sencillo:
<ol type="1">
<li class="fragment">Quitamos una observación de la base de datos.</li>
<li class="fragment">Ajustamos el modelo con los datos restantes.</li>
<li class="fragment">Predecimos la observación que hemos quitado al principio.</li>
<li class="fragment">Calculamos la log-densidad predictiva</li>
<li class="fragment">Repetimos esto para todas las observaciones.</li>
<li class="fragment">Sumamos las log-densidades predictivas.</li>
</ol></li>
</ul>
</section>
<section id="comparación-de-modelos-leave-one-out-1" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos: Leave-One-Out</h2>
<ul>
<li class="fragment">Ejemplo: <strong>regresión lineal simple</strong> (<span class="math inline">\(Y_i = \beta_0+\beta_1\cdot X_i + \varepsilon_i\)</span>)</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb115" data-code-line-numbers="|1|2-3|4-5|6-7|8-11|12-13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb115-2"><a href=""></a>  <span class="co"># Ajuste sin la i-ésima observación</span></span>
<span id="cb115-3"><a href=""></a>  fit_loo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y[<span class="sc">-</span>i] <span class="sc">~</span> x[<span class="sc">-</span>i])</span>
<span id="cb115-4"><a href=""></a>  <span class="co"># Predicción para la observación i</span></span>
<span id="cb115-5"><a href=""></a>  y_pred_i <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_loo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x[i]))</span>
<span id="cb115-6"><a href=""></a>  <span class="co"># Error de estimación sin la i-ésima obs</span></span>
<span id="cb115-7"><a href=""></a>  sigma_i <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_loo)<span class="sc">$</span>sigma</span>
<span id="cb115-8"><a href=""></a>  <span class="co"># Cálculo del log-densidad predictiva de y[i]</span></span>
<span id="cb115-9"><a href=""></a>  log_pdens[i] <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(y[i], <span class="at">mean =</span> y_pred_i, <span class="at">sd =</span> sigma_i, </span>
<span id="cb115-10"><a href=""></a>                        <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-11"><a href=""></a>}</span>
<span id="cb115-12"><a href=""></a><span class="co"># ELPD: suma de las log-densidades</span></span>
<span id="cb115-13"><a href=""></a>ELPD_loo <span class="ot">&lt;-</span> <span class="fu">sum</span>(log_pdens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="comparación-de-modelos-leave-one-out-2" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos: Leave-One-Out</h2>
<ul>
<li class="fragment"><p>ELPD son las siglas de <em>Expected log pointwise predictive density</em>, y su valor refleja la <strong>calidad predictiva del modelo.</strong></p></li>
<li class="fragment"><p>La comparación entre ELPDs permite saber <strong>qué modelo predice mejor los datos fuera de la muestra.</strong></p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\Delta\mbox{ELPD}_{\mathcal{M}_1,\,\mathcal{M}_2}=\mbox{ELPD}_{\mathcal{M}_1} - \mbox{ELPD}_{\mathcal{M}_2}
\]</span></p>
</div>
<ul>
<li class="fragment">El paquete <code>{loo}</code> estima <span class="math inline">\(\Delta\mbox{ELPD}_{\mathcal{M}_1,\,\mathcal{M}_2}\)</span> y su error típico.</li>
<li class="fragment">Si <span class="math inline">\(\Delta\mbox{ELPD}_{\mathcal{M}_1,\,\mathcal{M}_2}\)</span> es mayor que <span class="math inline">\(\pm 2\, \times\)</span> el error típico, <strong>la diferencia predictiva entre ambos modelos es significativa.</strong></li>
</ul>
</section>
<section id="limitaciones-de-leave-one-out" class="slide level2" data-visibility="uncounted">
<h2>Limitaciones de Leave-One-Out</h2>
<ul>
<li class="fragment">Las críticas más relevantes son:
<ul>
<li class="fragment">Computacionalmente costoso, <strong>intratable en bases de datos grandes</strong>.</li>
<li class="fragment"><strong>Sigue siendo sensible a las priors</strong>, aunque menos que el <span class="math inline">\(BF\)</span>.</li>
<li class="fragment">Asumen que los datos son intercambiables (i.e., no hay un efecto del tiempo).</li>
</ul></li>
<li class="fragment">Hay alternativas para algunos de los problenas:
<ul>
<li class="fragment"><strong>PSIS-LOO</strong>: versión adaptada a bases de datos grandes.</li>
<li class="fragment"><strong>Leave-future-one-out</strong> para tener en cuenta la secuencia temporal.</li>
</ul></li>
</ul>
</section>
<section id="conectando-ambos-mundos-pseudo-factor-de-bayes" class="slide level2" data-visibility="uncounted">
<h2>Conectando ambos mundos: Pseudo-factor de Bayes</h2>
<ul>
<li class="fragment">El Pseudo-factor de Bayes (<span class="math inline">\(\mbox{PsBF}\)</span>) <strong>compara la capacidad predictiva de dos modelos</strong> de forma similar al Factor de Bayes.</li>
<li class="fragment">Permite responder a la pregunta: <strong>¿Qué modelo predice mejor los datos observados?</strong></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\mbox{PsBF}_{12}=\exp\left(\Delta\mbox{ELPD}_{\mathcal{M}_1,\,\mathcal{M}_2}\right)
\]</span></p>
</div>
<ul>
<li class="fragment"><span class="math inline">\(\mbox{PsBF}_{12}=3\)</span> significa que las predicciones con el modelo <span class="math inline">\(\mathcal{M}_1\)</span> <strong>son <u>tres veces mejores</u></strong> que las predicciones con el modelo <span class="math inline">\(\mathcal{M}_2\)</span>.</li>
</ul>
</section>
<section id="comparación-de-modelos-4" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos</h2>
<ul>
<li class="fragment"><code>{blavaan}</code> incluye una estimación de la verosimilitud marginal y del factor de bayes basada en <strong>la aproximación de Laplace-Metrópolis</strong>.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href=""></a><span class="co"># Comparación de ELPDs</span></span>
<span id="cb116-2"><a href=""></a>blav_com_1f_2f<span class="sc">$</span>bf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         bf        mll1        mll2 
  -62.32224 -4102.84295 -4040.52072 </code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Como está en escala logarítmica, <strong>debemos exponenciarlo.</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href=""></a><span class="fu">c</span>(<span class="at">BF12 =</span> <span class="fu">exp</span>(blav_com_1f_2f<span class="sc">$</span>bf[<span class="dv">1</span>]), <span class="co"># BF12</span></span>
<span id="cb118-2"><a href=""></a>  <span class="at">BF21 =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">exp</span>(blav_com_1f_2f<span class="sc">$</span>bf[<span class="dv">1</span>])) <span class="co"># BF21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     BF12.bf      BF21.bf 
8.586119e-28 1.164671e+27 </code></pre>
</div>
</div>
</div>
</section>
<section id="comparación-de-modelos-5" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos</h2>
<ul>
<li class="fragment"><p>Los datos observados son <span class="math inline">\(1.16\times 10^{27}\)</span> <strong>veces más probables con el modelo de dos factores</strong> que con el modelo de un factor.</p></li>
<li class="fragment"><p>Finalmente, el <strong>Pseudo-Factor de Bayes</strong> se obtiene exponenciando <span class="math inline">\(\Delta\mbox{ELPD}\)</span>.</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href=""></a><span class="co"># Incremento el ELPD</span></span>
<span id="cb120-2"><a href=""></a>ELPD_diff <span class="ot">&lt;-</span> blav_com_1f_2f<span class="sc">$</span>diff_loo[<span class="dv">2</span>,<span class="st">"elpd_diff"</span>]</span>
<span id="cb120-3"><a href=""></a><span class="fu">c</span>(<span class="at">PsBF12 =</span> <span class="fu">exp</span>(ELPD_diff), <span class="at">PsBF21 =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">exp</span>(ELPD_diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PsBF12       PsBF21 
1.761748e-28 5.676181e+27 </code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">La <strong>capacidad predictive</strong> del modelo de dos factores es <span class="math inline">\(5.67\times 10^{27}\)</span> <strong>veces mejor</strong> que la del modelo de un factor.</li>
</ul>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>